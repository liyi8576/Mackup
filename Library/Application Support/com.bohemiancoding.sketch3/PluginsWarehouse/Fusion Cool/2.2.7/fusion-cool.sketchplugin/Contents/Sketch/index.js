var that=this;function __skpm_run(key,context){that.context=context;var exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="./src/index.js")}({"./node_modules/_@skpm_timers@0.1.0@@skpm/timers/test-if-fiber.js":function(t,e){t.exports=function(){return"undefined"!=typeof coscript&&coscript.createFiber}},"./node_modules/_@skpm_timers@0.1.0@@skpm/timers/timeout.js":function(t,e,n){var r,o,a=[];if(n("./node_modules/_@skpm_timers@0.1.0@@skpm/timers/test-if-fiber.js")()){a=[];r=function(t,e,n,r,o,i,s,c,l,u,h,p){var d=a.length;return a.push(coscript.scheduleWithInterval_jsFunction((e||0)/1e3,function(){t(n,r,o,i,s,c,l,u,h,p)})),d},o=function(t){var e=a[t];e&&(e.cancel(),a[t]=void 0)}}else r=function(t,e,n,r,i,s,c,l,u,h,p,d){coscript.shouldKeepAround=!0;var f=a.length;return a.push(!0),coscript.scheduleWithInterval_jsFunction((e||0)/1e3,function(){a[f]&&t(n,r,i,s,c,l,u,h,p,d),o(f),a.every(function(t){return!t})&&(coscript.shouldKeepAround=!1)}),f},o=function(t){a[t]=!1};t.exports={setTimeout:r,clearTimeout:o}},"./node_modules/_cocoascript-class@0.1.2@cocoascript-class/lib/index.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SuperCall=void 0,e.default=function(t){const e=t.superclass||NSObject,n=(t.className||t.classname||"ObjCClass")+NSUUID.UUID().UUIDString(),a=new Set(["className","classname","superclass"]);var i=MOClassDescription.allocateDescriptionForClassWithName_superclass_(n,e);const s=[];for(var c in t){const e=t[c];if("function"==typeof e&&"init"!==c){var l=NSSelectorFromString(c);i.addInstanceMethodWithSelector_function_(l,e)}else a.has(c)||(s.push(c),i.addInstanceVariableWithName_typeEncoding(c,"@"))}return i.addInstanceMethodWithSelector_function_(NSSelectorFromString("init"),function(){const e=o.call(this);return s.map(n=>{Object.defineProperty(e,n,{get:()=>(function(t,e){const n=MOPointer.new();return(0,r.object_getInstanceVariable)(t,e,n),n.value().retain().autorelease()})(e,n),set(t){(0,r.object_setInstanceVariable)(e,n,t)}}),e[n]=t[n]}),"function"==typeof t.init&&t.init.call(this),e}),i.registerClass()};var r=n("./node_modules/_cocoascript-class@0.1.2@cocoascript-class/lib/runtime.js");e.SuperCall=r.SuperCall;const o=(0,r.SuperCall)(NSStringFromSelector("init"),[],{type:"@"})},"./node_modules/_cocoascript-class@0.1.2@cocoascript-class/lib/runtime.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SuperCall=function(t,e,n){const o=a("objc_msgSendSuper",[{type:"^"+r},{type:":"},...e],n);return function(...e){const n=(r=this,a=this.superclass(),function t(e){if("object"!=typeof e||0==Object.keys(e).length)return e;const n=Object.keys(e)[0],r=e[n],o=MOStruct.structureWithName_memberNames_runtime(n,Object.keys(r),Mocha.sharedRuntime());return Object.keys(r).map(e=>{o[e]=t(r[e])}),o}({objc_super:{receiver:r,super_class:a}}));var r,a;const i=MOPointer.alloc().initWithValue_(n);return o(i,t,...e)}},e.CFunc=a;const r='{objc_super="receiver"@"super_class"#}';function o(t,e){const n=NSMutableDictionary.dictionary();n.o=t,Object.keys(e).map(t=>n.setValue_forKeyPath(e[t],"o."+t))}function a(t,e,n){function r(t){if(!t)return null;const e=MOBridgeSupportArgument.alloc().init();return o(e,{type64:t.type}),e}const a=MOBridgeSupportFunction.alloc().init();return o(a,{name:t,arguments:e.map(r),returnValue:r(n)}),a}e.object_getInstanceVariable=a("object_getInstanceVariable",[{type:"@"},{type:"*"},{type:"^@"}],{type:"^{objc_ivar=}"}),e.object_setInstanceVariable=a("object_setInstanceVariable",[{type:"@"},{type:"*"},{type:"@"}],{type:"^{objc_ivar=}"});!function(t,e){const n=MOBridgeSupportController.sharedController().valueForKey("symbols");if(!n)throw Error("Something has changed within bridge support so we can't add our definitions");if(null!==n[t])return;const r=MOBridgeSupportStruct.alloc().init();o(r,{name:t,type:e.type}),n[t]=r}("objc_super",{type:r})},"./package.json":function(t){t.exports=JSON.parse('{"name":"fusion-cool","description":"The Sketch plugin for Fusion Design.","version":"2.2.7","engines":{"sketch":">=3.0"},"scripts":{"prerelease":"npm run build","release":"node ./scripts/release.js","build":"npm run clean && skpm-build && npm run copy-framework","dev":"npm run clean && skpm-build && npm run copy-framework","start":"npm-run-all --parallel watch server log","3rd":"webpack --config ./webpack.config.js","watch":"skpm-build --watch","lint":"eslint src/","install":"npm run dev && skpm-link","link":"skpm-link","remove-framework":"trash ./fusion-cool.sketchplugin/Contents/Resources/FusionCoolOSX.framework","copy-framework":"cp -a ./Resources/FusionCoolOSX.framework ./fusion-cool.sketchplugin/Contents/Resources/","cmake":"cd OSX && sh rebuild.sh","cmake-test":"cd OSX && sh test.sh","save-framework":"cd ./resources && trash FusionCoolOSX.framework && cp -a ../OSX/build/FusionCoolOSX.framework .","test":"skpm-test","clean":"trash fusion-cool.sketchplugin","doc":"trash .apidoc/ && jsdoc -c jsdoc.json","log":"skpm log -f","server":"http-server -p 4001 ./api-test/ -s","doc-server":"http-server -p 4002 .apidoc -s"},"watch":{"dev":["./src/**/*.js"]},"husky":{"hooks":{"pre-commit":"eslint \'src/**/*.{js,ts}\'"}},"private":true,"appcast":"https://alifd.oss-cn-hangzhou.aliyuncs.com/sketch-fusion/appcast.xml","skpm":{"name":"Fusion Cool","manifest":"src/manifest.json","main":"fusion-cool.sketchplugin","assets":["assets/**/*"]},"devDependencies":{"@skpm/builder":"^0.5.2","@skpm/test-runner":"^0.4.0","ali-oss":"^6.0.1","babel-eslint":"^8.1.1","colors":"^1.3.2","crypto":"^1.0.1","docdash":"^1.1.1","eslint":"^4.15.0","eslint-config-airbnb":"^17.1.0","eslint-config-airbnb-base":"^13.1.0","eslint-config-ali":"^3.1.0","eslint-plugin-import":"^2.8.0","eslint-plugin-jsx-a11y":"^6.1.2","eslint-plugin-react":"^7.4.0","husky":"^2.7.0","md5":"^2.2.1","npm-run-all":"^4.1.5","ora":"^3.0.0","prompt-input":"^3.0.0","semver":"^5.6.0","trash-cli":"^3.0.0","uglify-es":"^3.3.9","webpack":"^4.39.2","webpack-cli":"^3.3.7","xml2js":"^0.4.19"},"dependencies":{"cocoascript-class":"^0.1.2","murmur2js":"^1.0.0","sketchapp-json-plugin":"^0.1.2"},"__npminstall_done":false}')},"./src/api/common-api.js":function(t,e,n){function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var a=n("./src/common/mocha.js"),i=n("./src/common/logger.js"),s=n("./src/common/image.js"),c=n("./src/common/sketch-layer.js"),l=n("./src/common/file.js"),u={deleteFolder:function(t){return l.isFileExists(t)?NSFileManager.defaultManager().removeItemAtPath_error(t,nil):(i.logInfo("deleteFolder:filepath not found:".concat(t)),0)},isAlibabaNet:function(){var t=a.httpHead({url:"https://fusion.alibaba-inc.com"});return t&&200===t.statusCode},logError:function(t){i.logError(t)},logSuccess:function(t){i.logSuccess(t)},logInfo:function(t){i.logInfo(t)},openURL:function(t){var e;/^file:\/\/\//.test(t)?(e=t.replace("file:///",""),e="file:///".concat(encodeURIComponent(e))):e=t;var n=NSURL.URLWithString(e);NSWorkspace.sharedWorkspace().openURL(n)},alert:function(t){var e=t.msg,n=t.title,r=NSAlert.new();r.messageText=n||"Alert",r.informativeText=e,r.runModal()},confirm:function(t){var e=t.title,n=t.msg,r=t.cancelText,o=void 0===r?"Cancel":r,a=t.okText,i=void 0===a?"OK":a,s=NSAlert.new();return s.messageText=e||"Confirm",s.informativeText=n,s.addButtonWithTitle(i),s.addButtonWithTitle(o),s.setAlertStyle(0),s.runModal()===NSAlertFirstButtonReturn},insertImageByUrl:function(t){var e=c.getSelected();return e&&e.length?s.insertImageByUrl_Layers(t,e):(i.logError("insertImageByUrl: no shapes selected"),0)}};t.exports=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach(function(e){o(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},u)},"./src/api/html2sketch/html2sketch.js":function(t,e,n){var r=n("./src/api/html2sketch/src/sketchapp-json-plugin.js"),o=n("./src/common/mocha.js"),a=n("./src/common/logger.js"),i=n("./src/api/html2sketch/src/utils.js"),s=i.hashStyle,c=i.getCached,l=i.setCached,u=i.fontNamesForFamilyName,h=i.weightOfFont,p=i.isItalicFont,d=i.isCondensedFont,f=i.FONT_WEIGHTS,m=i.APPLE_BROKEN_SYSTEM_FONT,g=i.FONT_STYLES,b=r.toSJSON;var S={getSVGSketchJSONString:function(t){var e=t.rawSVGString,n=t.frame,r=t.viewBox,o=t.borderLeftWidthFloat,i=void 0===o?0:o,s=t.borderTopWidthFloat,c=void 0===s?0:s,l=NSString.stringWithString(e).dataUsingEncoding(NSUTF8StringEncoding),u=MSSVGImporter.svgImporter(),h=null;try{u.prepareToImportFromData(l),h=u.importAsLayer()}catch(t){a.logError("getSVGSketchJSONString: SVG import failed: ".concat(t))}if(null===h)return null;var p=Math.min(n.width/r.width,n.height/r.height);1!==p&&h.multiplyBy(p);var d=h.rect().size;NSBundle.mainBundle().infoDictionary().CFBundleShortVersionString.UTF8String()<55?(h.rect={origin:{x:n.x,y:n.y},size:{width:n.width,height:n.height}},h.layers()[0].rect={origin:{x:(n.width-d.width)/2-r.x*p,y:(n.height-d.height)/2-r.y*p},size:{width:d.width,height:d.height}}):h.rect={origin:{x:n.x+(n.width-d.width)/2+i,y:n.y+(n.height-d.height)/2+c},size:{width:d.width,height:d.height}};var f=b(h);return"".concat(f)},makeImageDataFromUrl:function(t){var e,n,r=o.httpGetData(t);if(r){var a=r.subdataWithRange(NSMakeRange(0,1)).description(),i=a.match(/bytes = 0x(.+)}$/);if(i&&i.length>1&&(a="<".concat(i[1],">")),"<ff>"!=a&&"<89>"!=a&&"<47>"!=a&&"<49>"!=a&&"<4d>"!=a&&"<3c>"!=a)r=null;else if("<3c>"==a)return{isSVGImage:!0,SVGString:"".concat(NSString.alloc().initWithData_encoding_(r,NSUTF8StringEncoding))}}if(r)e=NSImage.alloc().initWithData(r);else{e=NSImage.alloc().initWithContentsOfURL(NSURL.URLWithString("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mM8w8DwHwAEOQHNmnaaOAAAAABJRU5ErkJggg=="))}var s={data:(n=void 0!==MSImageData.alloc().initWithImage_convertColorSpace?MSImageData.alloc().initWithImage_convertColorSpace(e,!1):MSImageData.alloc().initWithImage(e)).data().base64EncodedStringWithOptions(NSDataBase64EncodingEndLineWithCarriageReturn),sha1:n.sha1().base64EncodedStringWithOptions(NSDataBase64EncodingEndLineWithCarriageReturn)};return s.data="".concat(s.data),s.sha1="".concat(s.sha1),s},findFontName:function(t){var e=function(t){var e=s(t),n=c(e);if(n)return n;var r=NSFont.systemFontOfSize(14).familyName(),o=NSFontWeightRegular,a=t.fontSize?t.fontSize:14,i=t.fontWeight?f[t.fontWeight]:o,b=r==m?"Helvetica":r,S=!1,y=!1;t.fontFamily&&(b=t.fontFamily),t.fontStyle&&(S=g[t.fontStyle]||!1);var v=!1;if((b===r||"System"===b)&&(n=NSFont.systemFontOfSize_weight(a,i))&&(v=!0,S||y)){var w=n.fontDescriptor(),j=w.symbolicTraits();S&&(j|=NSFontItalicTrait),y&&(j|=NSFontCondensedTrait),w=w.fontDescriptorWithSymbolicTraits(j),n=NSFont.fontWithDescriptor_size(w,a)}var x=u(b),k=!1;v||0!==x.length||((n=NSFont.fontWithName_size(b,a))?(b=n.familyName(),i=t.fontWeight?i:h(n),S=t.fontStyle?S:p(n),y=d(n)):(k=!0,n=NSFont.systemFontOfSize_weight(a,i)));for(var N=1/0,F=0;F<x.length;F+=1){var O=NSFont.fontWithName_size(x[F],a);if(S===p(O)&&y===d(O)){var _=h(O);Math.abs(_-i)<Math.abs(N-i)&&(n=O,N=_)}}return n||x.length>0&&(n=NSFont.fontWithName_size(x[0],a)),n&&l(e,{font:n,failed:k}),{font:n,failed:k}}(t),n=e.font,r=e.failed;return{fontName:"".concat(n.fontDescriptor().postscriptName()),failed:r}}};t.exports=S},"./src/api/html2sketch/react2sketch.js":function(t,e,n){function r(t){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=n("./src/common/sketch-api.js"),a=n("./src/common/sketch-layer.js"),i={render:function(t){log("render");try{var e,n=t.renderData,i=t.dataset,s=t.bizchartData;/^<svg\b/i.test(n)?e=this.renderFromSVG(n):"object"==r(n)&&n._class&&(e=this.renderFromSketchJSON(n));var c=o.getLayer();if(!c)return log("no selected layer"),0;c.removeAllLayers();var l=e.layers(),u=e.frame().width(),h=e.frame().height();return NSBundle.mainBundle().infoDictionary().CFBundleShortVersionString.UTF8String()>=61&&i&&i.name&&i.name!=c.name()&&(c.frame().setX(c.frame().x()+c.frame().width()/2-u/2),c.frame().setY(c.frame().y()+c.frame().height()/2-h/2)),c.frame().setWidth(u),c.frame().setHeight(h),c.addLayers(l),i&&(i.name&&(c.name=i.name),a.setLayerData({key:"FusionCool",value:i})),s&&(s.name?c.name=s.name:c.name="Chart",a.setLayerData({key:"fusioncool-store-chart",value:s})),1}catch(t){return log("render error"),log(t),0}},renderSync:function(t){this.render({renderData:t.string,bizchartData:t.bizchartData})},handlerSvgMagicRules:function(){log("handlerSvgMagicRules");var t=o.getDocument().selectedLayers();if(1===t.containedLayersCount()&&"MSLayerGroup"==(t=t.layerAtIndex(0)).class()){var e=t.name(),n=/^__magic__FusionCool__(.*?)(?:__(.*))?$/.exec(e);if(n){var r="".concat(n[1],"-loading...");if("artboard"===n[2]){var a=t.ancestors()[t.ancestors().length-1],i=MSArtboardGroup.alloc().init();return i.frame().setX(t.frame().x()),i.frame().setY(t.frame().y()),i.frame().setWidth(t.frame().width()),i.frame().setHeight(t.frame().height()),a.removeLayer(t),a.addLayer(i),i.select_byExpandingSelection(!0,!1),(t=i).name=r,!0}t.name=r}}return!1},renderFromSVG:function(t){var e=MSSVGImporter.new(),n=NSString.stringWithString(t).dataUsingEncoding(NSUTF8StringEncoding);return e.prepareToImportFromData(n),e.importAsLayer()},getSystemFont:function(t){for(var e=t.fontFamily.length,n="",r=0;r<e;r+=1){var o=this.findFontName({fontFamily:t.fontFamily[r],fontWeight:t.fontWeight,fontSize:t.fontSize,fontStyle:t.fontStyle}),a=o.fontName;if(!o.failed)return a;n=a}return n},useSystemFont:function(t){var e=this;if("text"==t._class&&t.style&&t.style.textStyle){var n=t.style.textStyle.encodedAttributes.MSAttributedStringFontAttribute.attributes,r=n.name;if(r.fontFamily){var o=this.getSystemFont(r);n.name=o,t.attributedString.attributes[0].attributes.MSAttributedStringFontAttribute.attributes.name=o}}t.layers&&t.layers.length>0&&t.layers.forEach(function(t){return e.useSystemFont(t)})},renderFromSketchJSON:function(t){var e;this.useSystemFont(t);var n=NSBundle.mainBundle().infoDictionary().CFBundleShortVersionString.UTF8String();return(e=n&&+n<64?MSJSONDictionaryUnarchiver.unarchiveObjectFromDictionary_asVersion_corruptionDetected_error(t,"95",null,null):MSJSONDictionaryUnarchiver.unarchivedObjectFromDictionary_asVersion_corruptionDetected_error(t,"95",null,null)).class().mutableClass().alloc().initWithImmutableModelObject(e)}};t.exports=i},"./src/api/html2sketch/src/murmur2js.js":function(t,e){t.exports=function(t){for(var e,n=t.length,r=n,o=0;n>=4;)e=1540483477*(65535&(e=255&t.charCodeAt(o)|(255&t.charCodeAt(++o))<<8|(255&t.charCodeAt(++o))<<16|(255&t.charCodeAt(++o))<<24))+((1540483477*(e>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(e=1540483477*(65535&(e^=e>>>24))+((1540483477*(e>>>16)&65535)<<16)),n-=4,++o;switch(n){case 3:r^=(255&t.charCodeAt(o+2))<<16;case 2:r^=(255&t.charCodeAt(o+1))<<8;case 1:r=1540483477*(65535&(r^=255&t.charCodeAt(o)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0}},"./src/api/html2sketch/src/sketchapp-json-plugin.js":function(module,exports){function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t,e){for(var n in e)t[n]=e[n]}(exports,function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===_typeof(t)&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="./src/3-rd/sketchapp-json-plugin.js")}({"./node_modules/_invariant@2.2.4@invariant/invariant.js":function node_modules_invariant224InvariantInvariantJs(module,exports,__webpack_require__){"use strict";eval("/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\n\n/**\n * Use invariant() to assert state which your program assumes to be true.\n *\n * Provide sprintf-style format (only %s is supported) and arguments\n * to provide information about what broke and what you were\n * expecting.\n *\n * The invariant message will be stripped in production, but the invariant\n * will remain to ensure logic does not differ in production.\n */\n\nvar NODE_ENV = \"development\";\n\nvar invariant = function(condition, format, a, b, c, d, e, f) {\n  if (NODE_ENV !== 'production') {\n    if (format === undefined) {\n      throw new Error('invariant requires an error message argument');\n    }\n  }\n\n  if (!condition) {\n    var error;\n    if (format === undefined) {\n      error = new Error(\n        'Minified exception occurred; use the non-minified dev environment ' +\n        'for the full error message and additional helpful warnings.'\n      );\n    } else {\n      var args = [a, b, c, d, e, f];\n      var argIndex = 0;\n      error = new Error(\n        format.replace(/%s/g, function() { return args[argIndex++]; })\n      );\n      error.name = 'Invariant Violation';\n    }\n\n    error.framesToPop = 1; // we don't care about invariant's own frame\n    throw error;\n  }\n};\n\nmodule.exports = invariant;\n\n\n//# sourceURL=webpack:///./node_modules/_invariant@2.2.4@invariant/invariant.js?")},"./node_modules/_sketchapp-json-plugin@0.1.2@sketchapp-json-plugin/lib/index.js":function node_modules_sketchappJsonPlugin012SketchappJsonPluginLibIndexJs(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.appVersionSupported = appVersionSupported;\nexports.toSJSON = toSJSON;\nexports.fromSJSON = fromSJSON;\nexports.fromSJSONDictionary = fromSJSONDictionary;\n\nvar _invariant = __webpack_require__(/*! invariant */ \"./node_modules/_invariant@2.2.4@invariant/invariant.js\");\n\nvar _invariant2 = _interopRequireDefault(_invariant);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/*\nThis is pretty simplistic at the moment, since it doesn't handle references. More work is needed to actually\n*/\n\n/*\nVersions based on discussion info: http://sketchplugins.com/d/316-sketch-version\n*/\n// Internal Sketch Version (ex: 95 => v47 and below)\nvar SKETCH_HIGHEST_COMPATIBLE_VERSION = '95';\n// External Sketch Version\nvar SKETCH_LOWEST_COMPATIBLE_APP_VERSION = '43';\n\nvar envOK = typeof MSJSONDataArchiver !== 'undefined' && typeof MSJSONDictionaryUnarchiver !== 'undefined';\n\nfunction appVersion() {\n  if (typeof NSBundle !== 'undefined') {\n    return NSBundle.mainBundle().infoDictionary().CFBundleShortVersionString;\n  } else {\n    return undefined;\n  }\n}\n\nvar _checkEnv = function _checkEnv() {\n  return (0, _invariant2.default)(envOK, 'sketchapp-json-plugin needs to run within Sketch v' + SKETCH_LOWEST_COMPATIBLE_APP_VERSION + '+. You are running ' + appVersion());\n};\n\nfunction appVersionSupported() {\n  return envOK;\n}\n\n// Converts an object, eg from context.selection into its JSON string representation\nfunction toSJSON(sketchObject) {\n  _checkEnv();\n  if (!sketchObject) {\n    return null;\n  }\n  var imm = sketchObject.immutableModelObject();\n  return MSJSONDataArchiver.archiveStringWithRootObject_error_(imm, null);\n}\n\nfunction fromSJSON(json) {\n  _checkEnv();\n  var dict = JSON.parse(json);\n  if (!dict) return null;\n  if (dict._class.length <= 0) {\n    return null;\n  }\n  return fromSJSONDictionary(dict);\n}\n\n// Takes a Sketch JSON tree and turns it into a native object. May throw on invalid data\nfunction fromSJSONDictionary(jsonTree) {\n  _checkEnv();\n  var decoded = MSJSONDictionaryUnarchiver.unarchiveObjectFromDictionary_asVersion_corruptionDetected_error(jsonTree, SKETCH_HIGHEST_COMPATIBLE_VERSION, null, null);\n  var mutableClass = decoded.class().mutableClass();\n  return mutableClass.alloc().initWithImmutableModelObject(decoded);\n}\n\n//# sourceURL=webpack:///./node_modules/_sketchapp-json-plugin@0.1.2@sketchapp-json-plugin/lib/index.js?")},"./src/3-rd/sketchapp-json-plugin.js":function src3RdSketchappJsonPluginJs(module,exports,__webpack_require__){eval('const sketchApp = __webpack_require__(/*! sketchapp-json-plugin */ "./node_modules/_sketchapp-json-plugin@0.1.2@sketchapp-json-plugin/lib/index.js");\n\nmodule.exports = sketchApp;\n\n\n//# sourceURL=webpack:///./src/3-rd/sketchapp-json-plugin.js?')}}))},"./src/api/html2sketch/src/utils.js":function(t,e,n){function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach(function(e){a(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var i=n("./src/api/html2sketch/src/murmur2js.js"),s={},c=new Map,l={normal:0,bold:.4,100:-.8,200:-.6,300:-.4,400:0,500:.23,600:.3,700:.4,800:.56,900:.62};s.sortObjectKeys=function(t){return Object.keys(t).sort().reduce(function(e,n){return o(o({},e),{},{[n]:t[n]})},{})},s.hashStyle=function(t){return t?String(i(JSON.stringify(s.sortObjectKeys(t)))):"0"},s.isItalicFont=function(t){return 0!=(t.fontDescriptor().objectForKey(NSFontTraitsAttribute)[NSFontSymbolicTrait].unsignedIntValue()&NSFontItalicTrait)},s.isCondensedFont=function(t){return 0!=(t.fontDescriptor().objectForKey(NSFontTraitsAttribute)[NSFontSymbolicTrait].unsignedIntValue()&NSFontCondensedTrait)},s.weightOfFont=function(t){var e=t.fontDescriptor().objectForKey(NSFontTraitsAttribute)[NSFontWeightTrait].doubleValue();if(0===e){var n=Object.keys(l),r=String(t.fontName()).toLowerCase(),o=n.find(function(t){return r.endsWith(t)});if(o)return l[o]}return e},s.fontNamesForFamilyName=function(t){for(var e=NSFontManager.sharedFontManager(),n=NSArray.arrayWithArray(e.availableMembersOfFontFamily(t)),r=[],o=0;o<n.length;o+=1)r.push(n[o][0]);return r},s.getCached=function(t){return c.get(t)},s.setCached=function(t,e){c.set(t,e)},s.FONT_STYLES={normal:!1,italic:!0,oblique:!0},s.APPLE_BROKEN_SYSTEM_FONT=".AppleSystemUIFont",s.FONT_WEIGHTS=l,t.exports=s},"./src/api/http.js":function(t,e,n){var r=n("./src/common/mocha.js"),o=n("./src/common/logger.js"),a={buildIcsParam:function(t){var e=t.settings,n=t.sKey;r.loadFramework({});var o=ICSAuth.sharedInstance().getIcsParam_key(e,n);return"".concat(o)},httpGet:function(t){if(!t)return"[ERROR]httpGet(url:string) url should not be empty!";r.loadFramework({});var e=ICSRequest.sharedInstance().GET_setTimeout(t,10);return"".concat(e.body)},httpUpload:function(t){r.loadFramework({});var e=Object.assign({},t);e.timeout=e.timeout||"600";var n=ICSHttp.alloc().init().upload(e);return"".concat(n)},httpPOSTBody:function(t){var e=t.url,n=t.settings;r.loadFramework({});var a=ICSRequest.sharedInstance().POST_setTimeout_withHeaders_withParameters(e,"".concat(n.timeoutSec||5),n.headers,n.body);return a&&!a.body&&(o.logError("httpPOSTBody: ".concat(e)),o.logError(n),o.logError(a)),"".concat(a.body)},getMaterialParams:function(t){r.loadFramework({});var e=ICSAuth.sharedInstance().getMaterialParam(t);return"".concat(e)},icsUploadFile:function(t){var e={objectKey:t.objectKey,filepath:t.filepath,ossConfig:{AccessKeyId:t.AccessKeyId,AccessKeySecret:t.AccessKeySecret,SecurityToken:t.SecurityToken,bucketName:t.bucketName}};return r.uploadFileToOss(e)}};t.exports={httpGet:a.httpGet,httpUpload:a.httpUpload,httpPOSTBody:a.httpPOSTBody,getMaterialParams:a.getMaterialParams,buildIcsParam:a.buildIcsParam,icsUploadFile:a.icsUploadFile}},"./src/api/index.js":function(t,e,n){var r=n("sketch"),o=n("./src/common/sketch-api.js"),a=n("./src/api/common-api.js"),i=n("./src/api/layer.js"),s=n("./src/api/sketch.js"),c=n("./src/api/http.js"),l=n("./src/api/version.js"),u=n("./src/api/html2sketch/html2sketch.js"),h=n("./src/api/html2sketch/react2sketch.js"),p=r.Settings,d={CommonApi:a,Layer:i,SketchFun:s,Http:c,Version:l,HtmlToSketch:u,ReactToSketch:h},f={getData:function(t){var e=p.settingForKey(t);return e?"".concat(e):""},setData:function(t){var e=t.key,n=t.value;return p.setSettingForKey(e,n),1},showMessage:function(t){var e=o.getDocument();e&&e.showMessage(t)}};Object.keys(d).map(function(t){return Object.assign(f,d[t])}),t.exports=f},"./src/api/layer.js":function(t,e,n){var r=n("./src/common/sketch-api.js"),o=n("./src/common/sketch-layer.js"),a=n("./src/common/logger.js"),i=n("./src/common/util.js"),s=n("./src/common/cocoa-data.js"),c=n("./src/common/sketch-data.js"),l=n("./src/common/document.js"),u=n("./src/common/image.js"),h=n("./src/common/tools.js").sortArtboards,p={getSketchPagesArtboards:function(){var t=r.getPages(),e=r.getPage();if(!t||!t.length)return[];var n=[];return t.forEach(function(t){var r=[],o={name:"".concat(t.name()),id:"".concat(t.objectID()),type:"normal",artboards:r,isCurrent:t.objectID()==e.objectID()};if(l.isSymbolPage(t)&&(o.type="symbolPage"),t.artboards){var a=t.artboards();if(a&&a.length)h(a).forEach(function(t){r.push({name:"".concat(t.name()),id:"".concat(t.objectID())})})}n.push(o)}),n},getSketchSelections:function(){var t=o.getSelected(),e=[];return t&&t.length&&t.forEach(function(t){var n=t.frame(),r={name:"".concat(t.name()),id:"".concat(t.objectID()),type:"".concat(t.class()),width:Number("".concat(n.width())),height:Number("".concat(n.height()))},a=o.getLayerData("FusionCool");if(a)r.userData=a;else{var i=o.getLayerData("fusioncool-store-chart");r.userData=i}e.push(r)}),e},getLayerData:function(t){return o.getLayerData(t)},setCurrentLayerStyle:function(t){var e=o.getLayer(),n=Object.assign(t);if(!e||!n)return a.logError("setCurrentLayerStyle: no data or no selection"),0;var r=e.style();if(n.fillColor){var i=MSImmutableColor.colorWithSVGString(n.fillColor).newMutableCounterpart();r.fills().firstObject().setColor(i)}(n.borderWidth||0===n.borderWidth)&&((r.firstEnabledBorder()||r.addStylePartOfType(1)).thickness=Number(n.borderWidth));if(n.borderColor){var s=r.firstEnabledBorder()||r.addStylePartOfType(1),c=MSImmutableColor.colorWithSVGString(n.borderColor).newMutableCounterpart();s.color=c}if(n.shadow){var l=r.firstEnabledShadow()||r.addStylePartOfType(2),u=n.shadow.trim().split(" ");u.length>2?(u.push(u.splice(4).join("")),l.offsetY=parseFloat(u[1],10),l.blurRadius=parseFloat(u[2],10),l.spread=parseFloat(u[3],10),l.color=MSImmutableColor.colorWithSVGString(u[4]).newMutableCounterpart()):(l.offsetY=0,l.blurRadius=0,l.spread=0,l.color=MSImmutableColor.colorWithSVGString(u[4]).newMutableCounterpart())}if(n.borderRadius||0===n.borderRadius){if("string"==typeof n.borderRadius&&n.borderRadius.indexOf("%")){var h=Number(n.borderRadius.replace(/\D/g,""))/100,p=e.frame(),d=Number("".concat(p.width())),f=Number("".concat(p.height())),m=Math.max(d,f);n.borderRadius=parseFloat(m*h)}e.cornerRadiusFloat=n.borderRadius}if(n.color){var g=MSImmutableColor.colorWithSVGString(n.color);e.setTextColor(g)}return n.fontSize&&e.setFontSize(n.fontSize),n.linHeight&&e.setLineHeight(n.lineHeight),0},updateLayerData:function(t){var e=t.key,n=t.value;if(!o.getLayer())return 0;if("string"==typeof n)try{n=JSON.parse(n)}catch(t){a.logError("updateLayerData: ".concat(JSON.stringify(t)))}var r=o.getLayerData(e);if(r){var s=i.jsonExtend({from:n,to:r});o.setLayerData({key:e,value:s})}else o.setLayerData({key:e,value:n});return 1},getUploadDataForSelection:function(){var t=o.getSelected();if(!t)return 0;var e=[];return t.forEach(function(t){var n=t.frame(),o={name:s.nsstring2jsstring(t.name()),id:s.nsstring2jsstring(t.objectID()),width:Number("".concat(n.width())),base64Data:"".concat(u.getLayerImgData(t,"png",r.getDocument())),JSONData:"".concat(c.getLayerSketchJSON(t))};e.push(o)}),e},changeLayerName:function(t){var e=t.id,n=t.name;o.queryLayerByID(e).name=n}};t.exports=p},"./src/api/sketch.js":function(t,e,n){var r=n("./src/common/sketch-api.js"),o=n("./src/common/util.js"),a={appearance:function(){var t="light";return-1!=="".concat(NSAppearance.currentAppearance().name()).indexOf("Dark")&&(t="dark"),t},getSketchFileSize:function(){var t=this.getSketchFileURL();if(t=t.replace("file://",""),NSFileManager.defaultManager().fileExistsAtPath(t)){var e=NSFileManager.defaultManager().attributesOfItemAtPath_error(t,nil).fileSize();return e=(e=e/1024/1024).toFixed(1)}return 0},getSketchFileURL:function(){return decodeURIComponent("".concat(r.getDocument().fileURL()))},checkSketchUpadte:function(){return NSApp.delegate().checkForAndDownloadPluginUpdates(),1},openPluginList:function(){return MSPreferencesController.sharedController().switchToPaneWithIdentifier(MSPluginsPreferencePane.identifier()),1},getDocumentID:function(){return"".concat(r.getDocument().documentData().objectID())},getSketchFileName:function(){return decodeURIComponent("".concat(r.getDocument().fileURL())).split("/").pop().replace(/\.sketch/i,"")},getResourcePath:function(){return o.getResourcePath()}};t.exports=a},"./src/api/version.js":function(t,e,n){var r=n("./package.json"),o=n("./src/common/mocha.js"),a=n("./src/common/util.js"),i=n("./src/common/logger.js"),s={getPluginVersion:function(){return r.version},getLatestPluginVersion:function(){var t,e="https://alifd.oss-cn-hangzhou.aliyuncs.com/sketch-fusion/appcast.xml?t=".concat(Math.random()),n=o.httpGetData(e);if(!n)return"";try{t=o.xml2json(n),t=JSON.parse(t);var r="0.0.1";return t.rss.channel.item.forEach(function(t){var e=t.enclosure["sparkle:version"];a.versionCompare({version1:e,version2:r})>0&&(r=e)}),r}catch(t){i.logError(t)}return""},checkFusionCoolVersion:function(){var t=this.getLatestPluginVersion(),e=r.version;return a.versionCompare({version1:e,version2:t})>=0?1:0},getSketchVersion:function(){var t=NSBundle.mainBundle().infoDictionary().CFBundleShortVersionString;return"".concat(t)}};t.exports=s},"./src/common/cocoa-data.js":function(t,e){var n={jsstring2nsstring:function(t){return NSString.alloc().initWithFormat(t)},nsstring2jsstring:function(t){return"".concat(t)},nsstring2nsdata:function(t){return t.dataUsingEncoding(NSUTF8StringEncoding)},nsdata2nsstring:function(t){return NSString.alloc().initWithData_encoding(t,NSUTF8StringEncoding)},nsdata2base64string:function(t){return t.base64Encoding()},base64tonsdata:function(t){var e=NSData.alloc().initWithBase64EncodedString_options(t,0);return NSString.alloc().initWithData_encoding(e,NSUTF8StringEncoding)},jsstring2base64:function(t){var e=this.jsstring2nsstring(t),n=this.nsstring2nsdata(e),r=this.nsdata2base64string(n);return this.nsstring2jsstring(r)},nsdict2nsstring:function(t){var e=NSJSONSerialization.dataWithJSONObject_options_error(t,0,null);return NSString.alloc().initWithData_encoding(e,NSUTF8StringEncoding)},nsdict2json:function(t){var e=this.nsdict2nsstring(t),n=this.nsstring2jsstring(e);return JSON.parse(n)}};t.exports=n},"./src/common/document.js":function(t,e,n){var r=n("sketch"),o=n("./src/common/sketch-api.js"),a=r.Artboard,i=r.Rectangle,s=r.Shape,c=r.Group,l={isSymbolPage:function(t){var e=o.getDocument().documentData().symbolsPage();return!!e&&(!(!t||!t.class||t.class()!==MSPage)&&e.objectID()===t.objectID())},createArtboard:function(t){var e=t.name,n=t.parent,r=t.x,s=t.y,c=t.width,l=t.height,u={name:e||"".concat(+new Date),x:r||0,y:s||0,width:c||400,height:l||400,parent:n||o.getPage()};return new a({name:u.name,parent:u.parent,frame:new i(u.x,u.y,u.width,u.height)})},createShapeLayer:function(){return new s({name:"S1",parent:o.getArtboard(),frame:new i(0,0,100,100)})},createGroup:function(){return new c({name:"Group",parent:o.getArtboard(),frame:new i(0,0,100,100)})}};t.exports=l},"./src/common/file.js":function(t,e){var n={readFile:function(t){return this.isFileExists(t)?String(NSString.alloc().initWithContentsOfFile_encoding_error(t,NSUTF8StringEncoding,null)).toString():null},isFileExists:function(t){return NSFileManager.defaultManager().fileExistsAtPath(t)}};t.exports=n},"./src/common/image.js":function(t,e,n){var r=n("./src/common/sketch-api.js"),o=n("./src/common/mocha.js"),a={insertImageByUrl_Layers:function(t,e){var n=this,r=o.httpGetData(t),a=NSImage.alloc().initWithData_(r);return e.forEach(function(t){"".concat(t.class()).toLowerCase().indexOf("shape")>-1&&n.insertImageToShape(t,a)}),r=null,null},insertImageToShape:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=MSImageData.alloc().initWithImage(e),o=t.style();o.fills().firstObject().setFillType(4),o.fills().firstObject().setImage(r),o.fills().firstObject().setPatternFillType(n)},getLayerImgData:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"svg",o=(arguments.length>2?arguments[2]:void 0)||r.getDocument();if(MSExportRequest.exportRequestsFromExportableLayer)(e=MSExportRequest.exportRequestsFromExportableLayer(t).firstObject()).setScale(1);else{var a=t.absoluteInfluenceRect();(e=MSExportRequest.requestWithRect_sacle(a,1)).configureForLayer(t)}e.setSaveForWeb(!0);var i=NSProcessInfo.processInfo().globallyUniqueString(),s="Layer-export-".concat(t.objectID(),"__").concat(i,".").concat(n),c=NSTemporaryDirectory().stringByAppendingPathComponent(s);return o.saveArtboardOrSlice_toFile(e,c),NSData.dataWithContentsOfFile(c).base64EncodedStringWithOptions(0)}};t.exports=a},"./src/common/logger.js":function(t,e){var n={logWriteFile:function(t){ICSLog.sharedInstance().logToFile(t)},timeFormat:function(){var t=new Date,e=t.getFullYear(),n=t.getMonth(),r=t.getDate(),o=t.getHours(),a=t.getMinutes(),i=t.getSeconds();return n=n>10?n:"0".concat(n),r=r>10?r:"0".concat(r),o=o>10?o:"0".concat(o),a=a>10?a:"0".concat(a),i=i>10?i:"0".concat(i),"".concat(e,"/").concat(n,"/").concat(r," ").concat(o,":").concat(a,":").concat(i)},log:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){var e=t.content;log(e)}),logSuccess:function(t){return this.log({type:"[SUCCESS]",content:t}),null},logInfo:function(t){return this.log({type:"[INFO]",content:t}),null},logError:function(t){return this.log({type:"[ERROR]",content:t}),null}};t.exports=n},"./src/common/mocha.js":function(t,e,n){var r=n("./src/common/util.js"),o=n("./src/common/logger.js"),a=n("./src/common/cocoa-data.js"),i={loadFramework:function(t){var e=t.frameworkName,n=void 0===e?"FusionCoolOSX":e,a=t.frameworkPath;if("undefined"==typeof ICSRequest){var i=Mocha.sharedRuntime(),s=a||r.getResourcePath();this.removeQuarantineFlag(s);var c=i.loadFrameworkWithName_inDirectory_(n,s);return c?o.logInfo("加载Framework成功！"):o.logError("加载Framework失败!"),c}return 1},removeQuarantineFlag:function(t){var e=["-r","-d","com.apple.quarantine",t];NSTask.launchedTaskWithLaunchPath_arguments("/usr/bin/xattr",e).waitUntilExit()},httpGetData:function(t){return this.loadFramework({}),ICSRequest.sharedInstance().GetData_setTimeout(t,"10").body},httpHead:function(t){var e=t.url,n=t.delay,r=void 0===n?"1":n;this.loadFramework({});var i,s=ICSRequest.sharedInstance().HEAD_setTimeout(e,r),c=a.nsdict2nsstring(s);try{i=JSON.parse(c)}catch(t){o.logError("httpHead Error: ".concat(t))}return i},uploadFileToOss:function(t){var e=t.objectKey,n=t.filepath,r=t.ossConfig;this.loadFramework({});var a=r.AccessKeyId,i=r.AccessKeySecret,s=r.SecurityToken,c=r.bucketName,l=ICSOss.sharedInstance();return l.createClient({AccessKeyId:a,AccessKeySecret:i,SecurityToken:s})?l.uploadFile({objectKey:e,filepath:n,bucketName:c}):(o.logError("uploadFileToOss: oss.createClient fail"),!1)},logWriteFile:function(t){this.loadFramework({}),ICSLog.sharedInstance().logToFile(t)},xml2json:function(t){this.loadFramework({});var e=ICSRequest.sharedInstance().xml2json(t);return"".concat(e)}};t.exports=i},"./src/common/sketch-api.js":function(t,e,n){function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var a=n("sketch"),i={getDocuments:function(){var t=[];return a.getDocuments().forEach(function(e){e.sketchObject&&t.push(e.sketchObject)}),t},getDocument:function(){return a.getSelectedDocument().sketchObject},getPages:function(){var t=this.getDocument();return!!t&&t.pages()},getPage:function(){var t=this.getDocument();return!!t&&t.currentPage()},getArtboards:function(){var t=this.getDocument();return!!t&&t.artboards()},getArtboard:function(){var t=this.getPage();return!!t&&t.currentArtboard()},getLayers:function(){var t=this.getDocument();if(!t)return!1;var e=t.selectedLayers().layers();return!(!e||!e.length)&&e},getLayer:function(){var t=this.getLayers();return!(!t||!t.length)&&t[0]}};t.exports=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach(function(e){o(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},i)},"./src/common/sketch-data.js":function(t,e){var n={symbol2group_lt_53:function(t){var e=this;"MSSymbolInstance"==t.class()&&(t=t.detachByReplacingWithGroup()),"MSLayerGroup"==t.class()&&t.layers()&&t.layers().forEach(function(t){e.symbol2group_lt_53(t)})},symbol2group:function(t){var e=this;"MSSymbolInstance"==t.class()?t.detachStylesAndReplaceWithGroupRecursively(!0):"MSLayerGroup"!=t.class()&&"MSArtboardGroup"!=t.class()||!t.layers()||t.layers().forEach(function(t){e.symbol2group(t)})},getLayerSketchJSON:function(t){var e=t.copy(),n=t.parentGroup();n.addLayer(e),+NSBundle.mainBundle().infoDictionary().CFBundleShortVersionString.UTF8String()>=53?"MSSymbolInstance"==e.class()?e=e.detachStylesAndReplaceWithGroupRecursively(!0):this.symbol2group(e):this.symbol2group_lt_53(e);var r=e.immutableModelObject(),o=MSJSONDataArchiver.archiveStringWithRootObject_error_(r,null);return n.removeLayer(e),o}};t.exports=n},"./src/common/sketch-layer.js":function(t,e,n){var r=n("sketch"),o=n("./src/common/sketch-api.js"),a=r.Text,i=r.Rectangle,s={layer2json:function(t){var e=MSJSONDataArchiver.archiveStringWithRootObject_error(t.immutableModelObject(),nil);return"".concat(e)},currentLayerToJSON:function(){var t=this.getLayer();return t?this.layer2json(t):"[ERROR]currentLayerToJSON(); no layer selected!"},getLayerExportOptions:function(t){return t.exportOptions().exportFormats()[0]},isLayerExportable:function(t){return t.isLayerExportable()},queryLayerByID:function(t){var e=o.getDocument();return!!e&&e.documentData().layerWithID(t)},getArtboardOfLayer:function(t){return t.parentArtboard()},getPageOfLayer:function(t){return t.parentPage()},getLayerRect:function(t){if(!t)return"[ERROR]getLayerRect(layer); no layer selected!";var e=t.frame();return{x:e.x(),y:e.y(),width:e.width(),height:e.height()}},getCurrentLayerRect:function(){var t=this.getLayer();return t?this.getLayerRect(t):0},getLayerCss:function(t){return t?t.CSSAttributes():0},getCurrentLayerCss:function(){return this.getLayerCss(this.getLayer())},selectLayerByID:function(t){var e=this.queryLayerByID(t);return e&&e.select_byExpandingSelection(!0,!1),1},createTextLayer:function(t){var e=t.txt,n=t.x,r=t.y,s=t.color,c=t.size,l=t.weight,u=t.family,h=t.alignment,p=t.parent;new a({text:e,frame:new i(n||0,r||0,10,10),alignment:h||"left",parent:p||o.getPage(),style:{textColor:s||"#000",fontFamily:e||u,fontSize:c||30,fontWeight:l||6,borders:[]}}).adjustToFit()},getSelected:function(){return o.getLayers()},hasSelected:function(){var t=this.getSelected();return!(!t||!t.length)},getLayer:function(){var t=this.getSelected();return t&&t.length?t[0]:0},setLayerData:function(t){var e=t.key,n=t.value,o=this.getLayer();return o?(r.Settings.setLayerSettingForKey(o,e,n),this.getLayerDataFromNameSpace(e)&&this.setLayerDataFromNameSpace({key:e,value:""}),1):0},getLayerData:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLayer();if(!e)return 0;var n=this.getLayerDataFromNameSpace(t,e);if(n)return n;var o=r.Settings.layerSettingForKey(e,t);return o||0},getLayerDataFromNameSpace:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLayer();if(!e)return 0;var n=context.command.valueForKey_onLayer_forPluginIdentifier(t,e,"design.fusion.cool");if(n){var r;try{r=JSON.parse("".concat(n))}catch(t){log(t)}return r||"".concat(n)}return n},setLayerDataFromNameSpace:function(t){var e=t.key,n=t.value,r=this.getLayer();if(!r)return 0;return context.command.setValue_forKey_onLayer_forPluginIdentifier(n,e,r,"design.fusion.cool"),1}};t.exports=s},"./src/common/tools.js":function(t,e){function n(t,e){return t.frame().x()>e.frame().x()?1:-1}function r(t,e){return Number(t)>Number(e)?1:-1}t.exports={sortArtboards:function(t){var e={};t.slice().forEach(function(t){var n,r=t.frame().y(),o=!1;Object.keys(e).forEach(function(t){(r>t&&50>r-t||r<t&&50>t-r)&&(o=!0,n=t)}),e[r]||o||(e[r]=[]),e[o?n:r].push(t)});var o=[];return Object.keys(e).sort(r).forEach(function(t){var r=e[t].sort(n);o=o.concat(r)}),o}}},"./src/common/util.js":function(t,e){function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r={getResourcePath:function(){for(var t="".concat(coscript.env().scriptURL.path()),e=NSString.alloc().initWithString(t);"sketchplugin"!=="".concat(e.lastPathComponent().pathExtension());)e=e.stringByDeletingLastPathComponent();return"".concat(e,"/Contents/Resources")},getScreenInfo:function(){return{width:Number("".concat(NSScreen.mainScreen().frame().size.width)),height:Number("".concat(NSScreen.mainScreen().frame().size.height))}},appearance:function(){switch("".concat(NSAppearance.currentAppearance().name())){case"NSAppearanceNameAqua":case"NSAppearanceNameVibrantLight":case"NSAppearanceNameAccessibilityHighContrastAqua":case"NSAppearanceNameAccessibilityHighContrastVibrantLight":return"light";case"NSAppearanceNameDarkAqua":case"NSAppearanceNameVibrantDark":case"NSAppearanceNameAccessibilityHighContrastDarkAqua":case"NSAppearanceNameAccessibilityHighContrastVibrantDark":return"dark";default:return"unknown"}},version2number:function(t){var e=0;return t.split(".").forEach(function(t,n){e+=Number(t)*Math.pow(1e3,3-n)}),e},versionCompare:function(t){var e=t.version1,n=t.version2,r=this.version2number(e),o=this.version2number(n);return r>o?1:r===o?0:-1}};r.jsonExtend=function t(e){var r=e.from,o=e.to;return"object"!==n(r)?r:(r.constructor===Object?Object.keys(r).forEach(function(e){var a=r[e];"object"!==n(a)?o[e]=a:o[e]=t({from:a,to:o[e]||{}})}):r.constructor===Array&&("object"!==n(o)||o.constructor!==Array?o=r:r.forEach(function(t){o.push(t)})),o)},t.exports=r},"./src/dialog.js":function(t,e,n){"use strict";n.r(e);var r=n("./node_modules/_cocoascript-class@0.1.2@cocoascript-class/lib/index.js"),o=n.n(r),a=n("./src/wkwebview.js"),i={superclass:NSWindow,api:nil,init2:function(t,e){return this.standardWindowButton(NSWindowMiniaturizeButton).setHidden(!0),this.standardWindowButton(NSWindowZoomButton).setHidden(!0),this.setDelegate(this),this.api=e,this.viewInit(t,this.api),this},init3:function(t,e){this.standardWindowButton(NSWindowMiniaturizeButton).setHidden(!0),this.standardWindowButton(NSWindowZoomButton).setHidden(!0),this.setDelegate(this),this.api=e;var n=this.standardWindowButton(NSWindowCloseButton);return n.setTarget(this),n.setAction(NSStringFromSelector("customClose")),this.viewInit(t,this.api),this},viewInit:function(t,e){this.view=Object(a.createWebview)(),this.view.setAutoresizingMask(NSViewWidthSizable+NSViewHeightSizable),this.view.setFrame(this.contentView().bounds()),Object(a.addWebScriptHandler)(this.view,e),this.contentView().addSubview(this.view);var n=NSURLRequest.requestWithURL(NSURL.URLWithString(t));this.view.loadRequest(n)},customClose:function(){1==this.isVisible()&&this.setIsVisible(0)},stopBlocking:function(){NSApplication.sharedApplication().stopModal()},stop:function(){this.view.stopLoading(),this.stopBlocking(),this.close()},"windowWillClose:":function(){log("dialog closed"),this.stopBlocking()}};e.default=function(){return o()(i)}},"./src/export/DemoplusExporter.js":function(t,e,n){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n("./src/export/base.js"),a=n("./src/export/utils.js"),i=n("./src/export/template.js").TEMPLATE,s=function(){function t(e,n,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.document=r,this.sketchExportType="demo",this.userSettings=e||{},this.selectedArtboardAndPage=this.userSettings.selectedArtboardAndPage||[],this.message=n,this.getComponentInfo=o,this.jsonData={artboards:[],tree:[]},this.start=this.start.bind(this),this.onArtboardParseFinish=this.onArtboardParseFinish.bind(this),this.onAllArtboardsParseFinish=this.onAllArtboardsParseFinish.bind(this)}var e,n,s;return e=t,(n=[{key:"start",value:function(){this.startTime=+new Date,this.sketchFilePath=a.getSketchFileURL(this.document),this.filename=this.userSettings.filename||a.getFileName(this.sketchFilePath);var t=o.getDefaultExportTempFolder();a.deleteFolder(t);var e="".concat(t,"/").concat(this.filename);log("exportToDemoplus:sketchExportSavePath:".concat(e));var n=o.getMetaJSON(this.document,"./",this.selectedArtboardAndPage),r=n.artboards,i=n.layersCount,s=n.tree;this.jsonData.tree=s,this.message.$emit("onExportFileInfo",{artboardsTotal:r.length,layersCount:i});try{o.parseStart(this.document,r,this.onArtboardParseFinish,this.onAllArtboardsParseFinish,this.message,i,"./",e,this.sketchExportType,this.getComponentInfo)}catch(t){log("parse layer Error: ".concat(JSON.stringify(t)))}}},{key:"onAllArtboardsParseFinish",value:function(t,e){log("exportToDemoplus:onAllArtboardsParseFinish"),a.writeFile({text:"window.__JSONDATA__=".concat(JSON.stringify(this.jsonData)),filepath:"".concat(e,"/data/jsondata.js")}),a.writeFile({text:i,filepath:"".concat(e,"/index.html")});var n=e.split("/");n.pop(),n=n.join("/");var r="".concat(n,"/").concat(this.filename,".zip");a.zipFolder({from:e,to:r})?(log("exportToDemoplus:zipFile:done"),this.endTime=+new Date,t.$emit("onExportDemoPlusFinish",{zipFilePath:r,sketchFilePath:this.sketchFilePath,zipFileSize:o.getFileSize(r),uploadSuccessTime:this.endTime-this.startTime})):log("exportToDemoplus:zipFileError:zipFilePath:".concat(r,",sketchExportSavePath:").concat(e))}},{key:"onArtboardParseFinish",value:function(t){var e=t.artboard,n=t.artboardJson,r=t.sketchExportSavePath;log("exportToDemoPlus:onArtboardParseFinish");var o=Object.assign({},n),i="".concat(e.objectID()),s=e.frame().size();o.width=parseInt("".concat(s.width),10),o.height=parseInt("".concat(s.height),10),o.imagePath="./preview/".concat(i,".png"),o.thumbnail="./thumbnail/".concat(i,".png"),this.jsonData.artboards.push(o),a.exportSketchToFile({path:"".concat(r,"/"),layer:e,scale:2,name:i,subPath:"preview/",document:this.document}),a.exportSketchToFile({path:"".concat(r,"/"),layer:e,scale:.3,name:i,subPath:"thumbnail/",document:this.document})}}])&&r(e.prototype,n),s&&r(e,s),t}();t.exports=s},"./src/export/Exporter.js":function(t,e,n){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n("events"),a=n("./src/export/LocalExporter.js"),i=n("./src/export/DemoplusExporter.js"),s=n("./src/export/IcsZipExporter.js");o.prototype.$on=function(t,e){this.listenerCount(t)||this.on(t,e)},o.prototype.$emit=function(t,e){this._events[t]&&this.emit(t,e)};var c=["onExportProgress","onExportLocalFinish","onExportDemoPlusFinish","onExportICSZipFinish","onExportFileInfo"],l=function(){function t(e,n,r){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.message=new o,this.document=e,this.getComponentInfo=r,c.forEach(function(t){a.message.$on(t,function(e){n({type:t,data:e})})})}var e,n,l;return e=t,(n=[{key:"exportToLocal",value:function(t){new a(t,this.message,this.document,this.getComponentInfo).start()}},{key:"exportToDemoPlus",value:function(t){new i(t,this.message,this.document,this.getComponentInfo).start()}},{key:"exportToIcsZip",value:function(t){new s(t,this.message,this.document,this.getComponentInfo).start()}}])&&r(e.prototype,n),l&&r(e,l),t}();t.exports=l},"./src/export/IcsZipExporter.js":function(t,e,n){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n("./src/export/base.js"),a=n("./src/export/utils.js"),i=n("./src/export/template.js").TEMPLATE;var s=function(){function t(e,n,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.document=r,this.sketchExportType="icszip",this.userSettings=e||{},this.selectedArtboardAndPage=this.userSettings.selectedArtboardAndPage||[],this.message=n,this.getComponentInfo=o,this.jsonData={artboards:[],tree:[]},this.start=this.start.bind(this),this.onArtboardParseFinish=this.onArtboardParseFinish.bind(this),this.onAllArtboardsParseFinish=this.onAllArtboardsParseFinish.bind(this)}var e,n,s;return e=t,(n=[{key:"start",value:function(){this.startTime=+new Date,this.sketchFilePath=a.getSketchFileURL(this.document),this.filename=this.userSettings.filename||a.getFileName(this.sketchFilePath);var t=o.getDefaultExportTempFolder();a.deleteFolder(t);var e="".concat(t,"/").concat(this.filename);log("exportToIcsZip:sketchExportSavePath:".concat(e));var n=o.getMetaJSON(this.document,"./",this.selectedArtboardAndPage),r=n.artboards,i=n.layersCount,s=n.tree;this.jsonData.tree=s,this.message.$emit("onExportFileInfo",{artboardsTotal:r.length,layersCount:i});try{o.parseStart(this.document,r,this.onArtboardParseFinish,this.onAllArtboardsParseFinish,this.message,i,".",e,this.sketchExportType,this.getComponentInfo)}catch(t){log("parse layer Error: ".concat(JSON.stringify(t)))}}},{key:"onAllArtboardsParseFinish",value:function(t,e){log("exportToIcsZip:onAllArtboardsParseFinish"),a.writeFile({text:"window.__JSONDATA__=".concat(JSON.stringify(this.jsonData)),filepath:"".concat(e,"/data/jsondata.js")}),a.writeFile({text:i,filepath:"".concat(e,"/index.html")});var n=e.split("/");n.pop(),n=n.join("/");var r="".concat(n,"/").concat(this.filename,".zip");a.zipFolder({from:e,to:r})?(log("exportToIcsZip:zipFile:done"),this.endTime=+new Date,t.$emit("onExportICSZipFinish",{filePath:r,sketchFilePath:this.sketchFilePath,zipFileSize:o.getFileSize(r),uploadSuccessTime:this.endTime-this.startTime})):log("exportToIcsZip:zipFileError:zipFilePath:".concat(r,",sketchExportSavePath:").concat(e))}},{key:"onArtboardParseFinish",value:function(t){var e=t.artboard,n=t.artboardJson,r=t.sketchExportSavePath;log("exportToIcsZip:onArtboardParseFinish");var o=Object.assign({},n),i="".concat(e.objectID()),s=e.frame().size();o.width=parseInt("".concat(s.width),10),o.height=parseInt("".concat(s.height),10),o.imagePath="./preview/".concat(i,".png"),o.thumbnail="./thumbnail/".concat(i,".png");var c=[];!function t(e,n){var r=a.getUserData(e);if(!r||"block"!=r.type&&"scaffold"!=r.type||n.push({pkgName:r.pkgName,version:r.version,type:r.type,path:r.path}),e.layers){var o=e.layers();o&&o.length>0&&e.layers().forEach(function(e){return t(e,n)})}}(e,c),o.materials=c,this.jsonData.artboards.push(o),a.exportSketchToFile({path:"".concat(r,"/"),layer:e,scale:2,name:i,subPath:"preview/",document:this.document}),a.exportSketchToFile({path:"".concat(r,"/"),layer:e,scale:.3,name:i,subPath:"thumbnail/",document:this.document})}}])&&r(e.prototype,n),s&&r(e,s),t}();t.exports=s},"./src/export/LocalExporter.js":function(t,e,n){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n("./src/export/base.js"),a=n("./src/export/utils.js"),i=n("./src/export/template.js").TEMPLATE,s=function(){function t(e,n,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.document=r,this.sketchExportType="local",this.userSettings=e||{},this.selectedArtboardAndPage=this.userSettings.selectedArtboardAndPage||[],this.message=n,this.getComponentInfo=o,this.jsonData={artboards:[],tree:[]},this.start=this.start.bind(this),this.onArtboardParseFinish=this.onArtboardParseFinish.bind(this),this.onAllArtboardsParseFinish=this.onAllArtboardsParseFinish.bind(this)}var e,n,s;return e=t,(n=[{key:"start",value:function(){this.startTime=+new Date;var t=o.chooseLocalPathByUser(this.document);log("exportToLocal:sketchExportSavePath:".concat(t));var e=o.getMetaJSON(this.document,"./",this.selectedArtboardAndPage),n=e.artboards,r=e.layersCount,a=e.tree;this.jsonData.tree=a,this.message.$emit("onExportFileInfo",{artboardsTotal:n.length,layersCount:r});try{o.parseStart(this.document,n,this.onArtboardParseFinish,this.onAllArtboardsParseFinish,this.message,r,".",t,this.sketchExportType,this.getComponentInfo)}catch(t){log("parse layer Error: ".concat(JSON.stringify(t)))}}},{key:"onAllArtboardsParseFinish",value:function(t,e){log("exportToLocal:解析Layers成功");try{var n=JSON.stringify(this.jsonData);a.writeFile({text:"window.__JSONDATA__=".concat(n),filepath:"".concat(e,"/data/jsondata.js")}),a.writeFile({text:i,filepath:"".concat(e,"/index.html")}),this.endTime=+new Date,t.$emit("onExportLocalFinish",{filePath:e,uploadSuccessTime:this.endTime-this.startTime})}catch(t){log("onAllArtboardsParseFinish失败 ".concat(t))}}},{key:"onArtboardParseFinish",value:function(t){var e=t.artboard,n=t.artboardJson,r=t.sketchExportSavePath;log("exportToLocal:onArtboardParseFinish");var o=Object.assign({},n),i="".concat(e.objectID()),s=e.frame().size();o.width=parseInt("".concat(s.width),10),o.height=parseInt("".concat(s.height),10),o.imagePath="./preview/".concat(i,".png"),o.thumbnail="./thumbnail/".concat(i,".png"),this.jsonData.artboards.push(o),a.exportSketchToFile({path:"".concat(r,"/"),layer:e,scale:2,name:i,subPath:"preview/",document:this.document}),a.exportSketchToFile({path:"".concat(r,"/"),layer:e,scale:.3,name:i,subPath:"thumbnail/",document:this.document})}}])&&r(e.prototype,n),s&&r(e,s),t}();t.exports=s},"./src/export/base.js":function(t,e,n){(function(e){function r(t){"@babel/helpers - typeof";return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=n("./src/export/parse/index.js"),a=n("./src/export/config.js").sleepTimeout,i=n("./src/export/utils.js"),s=n("./src/common/tools.js").sortArtboards,c={getFileSize:function(t){if(NSFileManager.defaultManager().fileExistsAtPath(t)){var e=NSFileManager.defaultManager().attributesOfItemAtPath_error(t,nil).fileSize();return e=(e=e/1024/1024).toFixed(1)}return null},getDefaultExportTempFolder:function(){return"".concat(NSHomeDirectory(),"/.FuisonCoolExport")},chooseLocalPathByUser:function(t){var e=t.displayName().stringByDeletingPathExtension(),n=NSSavePanel.savePanel();return n.setCanCreateDirectories(!0),n.setNameFieldStringValue(e),n.runModal()==NSOKButton?"".concat(n.URL().path()):""},getMetaJSON:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"./",n=arguments.length>2?arguments[2]:void 0,r={artboards:{},documentID:"".concat(t.documentData().objectID())},o=0,a=[],i=[],c=t.pages(),l=c.length-1;l>=0;l-=1){var u=c[l];"Symbols"!==u.name()&&"组件"!==u.name()&&function(){var t={type:"page",name:"".concat(u.name()),objectID:"".concat(u.objectID()),artboards:[]},c=!1,l=u.artboards();s(l).forEach(function(i){var s="".concat(i.objectID());-1!==n.indexOf(s)&&(c=!0,a.push(i),o+=i.children().count(),r.artboards[s]={imagePath:"".concat(e,"/preview/").concat(s,".png"),artboardName:"".concat(i.name()),dataPath:"".concat(e,"/data/").concat(s,".json"),objectID:s},t.artboards.push({type:"artboard",name:"".concat(i.name()),objectID:s,width:Number("".concat(i.frame().width())),height:Number("".concat(i.frame().height()))}))}),c&&i.unshift(t)}()}return{meta:r,artboards:a,layersCount:o,tree:i}},duplicateAllSymbols:function(t,n,r,o){var a=this,s=[],c=[],l=0;t.slice().forEach(function(t){t.children().forEach(function(t){t.class()===MSSymbolInstance&&c.push(t)})});var u=c.length;r.$emit("onExportProgress",{i18nKey:"symbolTransforming",processText:"Symbol Transforming..."});!function t(){if(l>=u||0===u)n&&n(s);else{var h=a.symbolTransformToGroup(c[l]);h&&s.push(h),i.calculateProgress({index:l,totalCount:u,step:"first",message:r,sketchExportType:o}),l+=1,e(t,0)}}()},symbolTransformToGroup:function(t){var e,n=t.duplicate();return n.detachStylesAndReplaceWithGroupRecursively?e=n.detachStylesAndReplaceWithGroupRecursively(!0):n.detachByReplacingWithGroup&&(e=n.detachByReplacingWithGroup()),e&&e.resizeToFitChildrenWithOption&&e.resizeToFitChildrenWithOption(0),e},clearTempSymbolGroups:function(t){var n=t.groups,r=t.nextTick;t.message.$emit("onExportProgress",{i18nKey:"symbolGroupsClear",processText:"Symbol Temp Group Cleaning..."});!function t(){if(0===n.length)r&&r();else{var o=n.shift();i.removeLayer(o),e(t,0)}}()},parseStart:function(t,n){var s,c,l,u,h,p=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},f=arguments.length>4?arguments[4]:void 0,m=arguments.length>5?arguments[5]:void 0,g=arguments.length>6?arguments[6]:void 0,b=arguments.length>7?arguments[7]:void 0,S=arguments.length>8?arguments[8]:void 0,y=arguments.length>9?arguments[9]:void 0,v=n.slice(),w=v.length,j=0,x=0,k=0;try{!function n(){if(0===j&&(s=v[x],c="".concat(s.objectID()),l=s.children(),u=l.count(),h={layers:{},slices:{},objectID:c,name:"".concat(s.name())}),j>=u)return x+=1,j=0,log("Artboart Progress: ".concat(x," / ").concat(w)),p({artboardJson:h,artboard:s,sketchExportSavePath:b}),void(x>=w?(d(f,b),j=null,x=null,s=null,c=null,l=null,u=null,h=null,v=null,w=null):e(function(){n()},1e3*a));var N=l[j];j+=1,k+=1,i.calculateProgress({index:k,totalCount:m,step:"first",message:f,sketchExportType:S});try{if(i.isClass(N,MSSymbolInstance))o(t,N,s,g,b,y).forEach(function(t){var e=t;e.sliceData&&(h.slices[e.layerID]=e.sliceData),e.layerData&&("object"===r(e.layerData)&&e.layerData.constructor===Array?e.layerData.forEach(function(t){h.layers[t.objectID]=t}):e.layerData&&(h.layers[e.layerId]=e.layerData))});else{var F=o(t,N,s,g,b,y),O=F.sliceData,_=F.layerData;O&&(h.slices[N.objectID()]=O),_&&("object"===r(_)&&_.constructor===Array?_.forEach(function(t){h.layers[t.objectID]=t}):_&&(h.layers[N.objectID()]=_))}}catch(t){log("parseLayerError: ".concat(JSON.stringify(t)))}e(function(){n()},1e3*a)}()}catch(t){log("layersParseFactorialError: ".concat(JSON.stringify(t))),log("errorInfo: ".concat(JSON.stringify({artboardsID:"".concat(c),artboartName:"".concat(s.name()),layerIndex:"".concat(j),layerName:"".concat(l[j].name()),layerID:"".concat(l[j].objectID())})))}}};t.exports=c}).call(this,n("./node_modules/_@skpm_timers@0.1.0@@skpm/timers/timeout.js").setTimeout)},"./src/export/config.js":function(t,e){t.exports={sleepTimeout:0,stepPercent:{first:70},localStepPercent:{first:100}}},"./src/export/parse/canvas.js":function(t,e,n){var r=n("./src/export/parse/color.js"),o=["linear","radial","angular"],a=["center","inside","outside"],i=["color","gradient"],s={getRadius:function(t){return t.class()===MSRectangleShape?1==t.cornerRadiusString().split(";").map(Number).length?t.fixedRadius():t.cornerRadiusString().split(";").map(Number):[]},getBorders:function(t){for(var e=[],n=t.borders().objectEnumerator(),o=n.nextObject();o;){if(o.isEnabled()){var s=i[o.fillType()],c={fillType:s,position:a[o.position()],thickness:o.thickness()};switch(s){case"color":c.color=r.colorToJSON(o.color());break;case"gradient":c.gradient=this.gradientToJSON(o.gradient())}e.push(c)}o=n.nextObject()}return e},shadowToJSON:function(t){return{type:t instanceof MSStyleShadow?"outer":"inner",offsetX:t.offsetX(),offsetY:t.offsetY(),blurRadius:t.blurRadius(),spread:t.spread(),color:r.colorToJSON(t.color())}},getShadows:function(t){for(var e=[],n=t.shadows().objectEnumerator(),r=n.nextObject();r;)r.isEnabled()&&e.push(this.shadowToJSON(r)),r=n.nextObject();for(r=(n=t.innerShadows().objectEnumerator()).nextObject();r;)r.isEnabled()&&e.push(this.shadowToJSON(r)),r=n.nextObject();return e},getFills:function(t){for(var e=[],n=t.fills().objectEnumerator(),o=n.nextObject();o;){if(o.isEnabled()){var a=i[o.fillType()],s={fillType:a};switch(a){case"color":s.color=r.colorToJSON(o.color());break;case"gradient":s.gradient=this.gradientToJSON(o.gradient())}e.push(s)}o=n.nextObject()}return e},getRect:function(t){var e=t.absoluteRect();return{x:Math.round(e.x()),y:Math.round(e.y()),width:Math.round(e.width()),height:Math.round(e.height()),maxX:Math.round(e.x()+e.width()),maxY:Math.round(e.y()+e.height()),setX:function(t){e.setX(t),this.x=t,this.maxX=this.x+this.width},setY:function(t){e.setY(t),this.y=t,this.maxY=this.y+this.height},setWidth:function(t){e.setWidth(t),this.width=t,this.maxX=this.x+this.width},setHeight:function(t){e.setHeight(t),this.height=t,this.maxY=this.y+this.height}}},getTextAttrs:function(t){for(var e={},n=new RegExp('([a-z-]+)="([^"]+)"',"g"),r=new RegExp('([a-z-]+)="([^"]+)"'),o=t.match(n),a=0;a<o.length;){var i=r.exec(o[a]),s=i[1],c=i[2];e[s]=c,a+=1}return e},addText:function(){var t=MSTextLayer.new();return t.setStringValue("text"),t},gradientToJSON:function(t){for(var e=[],n=t.stops().objectEnumerator(),a=n.nextObject();a;)e.push(r.colorStopToJSON(a)),a=n.nextObject();return{type:o[t.gradientType()],from:{x:parseFloat(t.from().x),y:parseFloat(t.from().y)},to:{x:parseFloat(t.to().x),y:parseFloat(t.to().y)},colorStops:e}}};t.exports=s},"./src/export/parse/color.js":function(t,e){var n={colorStopToJSON:function(t){return{color:this.colorToJSON(t.color()),position:t.position()}},colorToJSON:function(t){return{r:Math.round(255*t.red()),g:Math.round(255*t.green()),b:Math.round(255*t.blue()),a:t.alpha(),"color-hex":"".concat(t.immutableModelObject().stringValueWithAlpha(!1)," ").concat(Math.round(100*t.alpha()),"%"),"argb-hex":this.colorToARGB(t),"css-rgba":"rgba(".concat([Math.round(255*t.red()),Math.round(255*t.green()),Math.round(255*t.blue()),Math.round(100*t.alpha())/100].join(","),")"),"ui-color":"(".concat(["r:".concat((Math.round(100*t.red())/100).toFixed(2)),"g:".concat((Math.round(100*t.green())/100).toFixed(2)),"b:".concat((Math.round(100*t.blue())/100).toFixed(2)),"a:".concat((Math.round(100*t.alpha())/100).toFixed(2))].join(" "),")")}},colorToARGB:function(t){var e="".concat(t.immutableModelObject().stringValueWithAlpha(!1)).replace(/#/,""),n=t.alpha(),r=(255*Number(n)).toString(16);return"#".concat(r).concat(e)},hexToRgb:function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:this.toHex(e[1]),g:this.toHex(e[2]),b:this.toHex(e[3])}:null},toHex:function(t){var e=parseInt(t,16);return 1==e.length?"0".concat(e):e},colorToMSColor:function(t){return MSImmutableColor.colorWithSVGString(t).newMutableCounterpart()},rgbaToMSColor:function(t){var e=t.r,n=t.g,r=t.b,o=t.a;return MSColor.colorWithRed_green_blue_alpha(e,n,r,o)}};t.exports=n},"./src/export/parse/index.js":function(t,e,n){function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(t){o=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw a}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach(function(e){s(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var c=n("./src/export/parse/canvas.js"),l=n("./src/export/parse/color.js"),u=n("./src/export/utils.js");function h(t,e,n,r,o,a){var i=u.isClass(e,MSSymbolInstance);if(!d(e))return i?[]:{};if(i){var s=function(t){var e,n=t.duplicate();n.detachStylesAndReplaceWithGroupRecursively?e=n.detachStylesAndReplaceWithGroupRecursively(!0):n.detachByReplacingWithGroup&&(e=n.detachByReplacingWithGroup());e&&e.resizeToFitChildrenWithOption&&e.resizeToFitChildrenWithOption(0);return e}(e),c=s.children(),l=c.count(),h=0,f=[];try{!function e(){var i,u,m=c[h];if(d(m)){var g=p(t,m,n,r,o,a),b=g.layerData,S=g.sliceData;f.push({layerId:m.objectID(),layerData:b,sliceData:S})}h>=l-1?(u=(i=s).parentGroup())&&u.removeLayer(i):(h+=1,e())}()}catch(t){log("layersParseError: ".concat(JSON.stringify(err)))}return f}return p(t,e,n,r,o,a)}function p(t,e,n,o,a,s){var p=n.absoluteRect(),d="".concat(e.objectID()),f="".concat(e.name()),m="".concat(e.class()),g={objectID:d,name:f,type:m,rect:u.rectToJSON({rect:e.absoluteRect(),referenceRect:p})};if("".concat(e.absoluteRect())=="".concat(e.parentGroup().absoluteRect())&&s){var b=s(e.parentGroup());b&&(g.webComponent=b)}if(s){var S=s(e);S&&(g.webComponent=S)}var y=null;if((u.hasExportOptions(e)||"MSSliceLayer"===m)&&o&&a){var v=function(t){var e=t.layer,n=t.artboard,r=t.baseData,o=t.sketchExportSlicePath,a=t.sketchExportSavePath,s=t.document,c=n.objectID(),l=e.objectID(),h=e.exportOptions().exportFormats(),p=h&&h.length?"".concat(h[0].fileFormat()):"png",d="assets/".concat(c,"/").concat(l,".").concat(p),f="".concat(o,"/").concat(d),m=Array.isArray(r)?r.map(function(t){return i(i({},t),{},{type:"slice"})}):i(i({},r),{},{type:"slice"}),g=i(i({},m),{},{exportable:[{name:r.name,format:p,path:f}]});return u.exportSketchToFile({layer:e,path:"".concat(a,"/"),subPath:"assets/".concat(c,"/"),scale:2,name:l,format:p,document:s}),{sliceData:g,layerData:m}}({layer:e,artboard:n,baseData:g,sketchExportSlicePath:o,sketchExportSavePath:a,document:t});g=v.layerData,y=v.sliceData}switch(m){case"MSTextLayer":var w=function(t){var e=t.layer,n=t.baseData,o=t.artboard,a=t.document;return{layerData:function(t){var e=t.layer,n=t.baseData,o=t.artboard,a=t.document;if(!u.isClass(e,MSTextLayer))return n;if(e.disableCheckSvgText)return n;if(!function(t){var e=0;if(!u.isClass(t,MSTextLayer))return!1;try{e=t.attributedString().treeAsDictionary().value.attributes.length}catch(t){log("isSvgTextError: layer.attributedString().treeAsDictionary().value.attributes.length")}return e>1}(e))return n;var i,s,p=Object.assign({},n),d=SketchSVGExporter.new().exportLayers([e.immutableModelObject()]),f="".concat(NSString.alloc().initWithData_encoding(d,4)),m=new RegExp("<tspan([^>]+)>([^<]*)</tspan>","g"),g=new RegExp(">([^<]*)<"),b=[],S=c.getRect(e);f.match(m).forEach(function(t){var e=c.getTextAttrs(t),n=t.match(g);if(n&&n.length>1){var o=r(n,2),a=o[1];e.content=a}(void 0==i||i>u.nsstring2jsnumber(e.x))&&(i=u.nsstring2jsnumber(e.x)),(void 0==s||s>u.nsstring2jsnumber(e.y))&&(s=u.nsstring2jsnumber(e.y)),b.push(e)});var y=e.parentGroup(),v=p.lineHeight,w=p.letterSpacing,j=p.textAlign,x=p.fontFace,k=[];return b.forEach(function(t){if(t.content.trim()&&t.fill){var e=c.addText(),n=l.hexToRgb(t.fill);if(n&&Object.prototype.hasOwnProperty.call(n,"r")){var r=MSColor.colorWithRed_green_blue_alpha(n.r/255,n.g/255,n.b/255,t["fill-opacity"]||1);e.setName(t.content),e.setStringValue(t.content),e.setTextColor(r),e.setFontSize(t["font-size"]||p.fontSize),e.setLineHeight(v),e.setCharacterSpacing(u.nsstring2jsnumber(t["letter-spacing"])||w),e.setTextAlignment(j),t["font-family"]?e.setFontPostscriptName(t["font-family"].split(",")[0]):e.setFontPostscriptName(x),y.addLayers([e]);var d=c.getRect(e);d.setX(S.x+(u.nsstring2jsnumber(t.x)-i)),d.setY(S.y+(u.nsstring2jsnumber(t.y)-s)),e.disableCheckSvgText=!0;var f=h(a,e,o);p=f.layerData,k.push(p),u.removeLayer(e)}}}),k}({baseData:Object.assign({},n,{content:"".concat(e.stringValue()),color:l.colorToJSON(e.textColor()),fontSize:e.fontSize(),fontFace:"".concat(e.fontPostscriptName()),textAlign:e.textAlignment(),letterSpacing:e.characterSpacing()||0,lineHeight:e.lineHeight()||e.font().defaultLineHeightForFont(),css:u.nsarray2jsarray(e.CSSAttributes())}),layer:e,artboard:o,document:a})}}({layer:e,artboard:n,baseData:g,document:t});g=w.layerData;break;case"MSBitmapLayer":case"MSArtboardGroup":break;default:if(e.style&&e.style())g=function(t){var e=t.layer,n=t.baseData,r=e.style();return{layerData:Object.assign({},n,{css:u.nsarray2jsarray(e.CSSAttributes()),rotation:e.rotation(),radius:c.getRadius(e),borders:c.getBorders(r),shadows:c.getShadows(r),fills:c.getFills(r)})}}({layer:e,baseData:g}).layerData}return{layerData:g,sliceData:y}}function d(t){return!!t&&(!!t.isVisible()&&(!function(t){var e=t,n=!1;for(;!n&&e&&e.parentGroup;)e&&e.isVisible&&e.isVisible()?e=e.parentGroup():n=!0;return n}(t)&&((!t.booleanOperation||1!==t.booleanOperation())&&(!function(t){if(t.parentGroup){var e=t.parentGroup();if(!e||!e.class||e.class()!==MSShapeGroup)return!1;var n=c.getFills(e.style()),r=!1;return n&&n.length&&n.forEach(function(t){r||"color"===t.fillType&&(r=!0)}),r}return!1}(t)&&!(u.isClass(t,MSTextLayer)&&t.isEmpty&&t.isEmpty())))))}t.exports=h},"./src/export/template.js":function(t,e){t.exports={TEMPLATE:'<!DOCTYPE html>\n<html lang="en">\n<head>\n<meta charset="UTF-8">\n<meta name="viewport" content="width=device-width, initial-scale=1.0">\n<meta http-equiv="X-UA-Compatible" content="ie=edge">\n<title>FusionCool标注</title>\n</head>\n<body>\n\n<style>\n#app{position: absolute;top:0;left:0;width: 100%;height:100%;}\n</style>\n<div id="app"></div>\n<script src="./data/jsondata.js" type="text/javascript"><\/script>\n<script src="https://g.alicdn.com/fusion-platform/sketch-markup/style.js" type="text/javascript"><\/script>\n<script src="https://g.alicdn.com/fusion-platform/sketch-markup/app.js" type="text/javascript"><\/script>\n</body>\n</html>'}},"./src/export/utils.js":function(t,e,n){var r=n("sketch"),o=n("./src/export/config.js"),a=o.stepPercent,i=o.localStepPercent,s={calculateProgress:function(t){if(t.index&&t.totalCount&&t.totalCount>=t.index){var e="local"==="".concat(t.SketchExportType)?i:a,n=e[t.step],r=t.prevStepPercent?e[t.step]+t.prevStepPercent:e[t.step],o=parseInt(t.index/t.totalCount*n,10),s=t.prevStepPercent||0;o>=n||(o=Math.min(o+s,r),t.message.$emit("onExportProgress",{progress:o,i18nKey:"layerAnalysis",processText:"Sketch Layer Analysis"}))}},isClass:function(t,e){return t.class&&t.class()===e},zipFolder:function(t){var e=t.from,n=t.to,r=NSTask.alloc().init();r.setLaunchPath("/usr/bin/ditto");var o=NSMutableArray.arrayWithObject("-c");return o.addObject("-k"),o.addObject("-X"),o.addObject("--rsrc"),o.addObject(e),o.addObject(n),r.setArguments(o),r.launch(),r.waitUntilExit(),0===r.terminationStatus()},nsstring2jsnumber:function(t){return Number("".concat(t))},nsarray2jsarray:function(t){for(var e=[],n=0;n<t.count();)e.push("".concat(t[n])),n+=1;return e},getSketchFileURL:function(t){return decodeURIComponent("".concat(t.fileURL()))},getFileName:function(t){return t.split("/").pop()},writeFile:function(t){var e=t.text,n=t.filepath,r=n.split("/");r.pop(),r=r.join("/"),NSFileManager.defaultManager().createDirectoryAtPath_withIntermediateDirectories_attributes_error(r,!0,nil,nil);var o=MOPointer.alloc().init();NSString.stringWithString(e).writeToFile_atomically_encoding_error(n,!1,4,o)},exportSketchToFile:function(t){var e=Object.assign({layer:"",path:"",scale:1,name:"",prefix:"",suffix:"",format:"png",subPath:"preview/"},t);if(!e.layer||!e.path||!e.name)return log("writeImageFileError: ".concat(JSON.stringify(t))),"";var n=MSExportRequest.exportRequestsFromExportableLayer(e.layer).firstObject(),r=[];n.scale=e.scale,n.format=e.format,r.push(e.path,e.subPath,e.prefix,e.name,e.suffix,".",e.format);var o=r.join("");return e.document.saveArtboardOrSlice_toFile(n,o),o},deleteFolder:function(t){var e=NSFileManager.defaultManager();return e.fileExistsAtPath(t)?e.removeItemAtPath_error(t,nil):(log("deleteFolder:filepath not found:".concat(t)),0)},hasExportOptions:function(t){return t.exportOptions().exportFormats().count()>0},removeLayer:function(t){if(t&&t.parentGroup){var e=t.parentGroup();e&&e.removeLayer&&e.removeLayer(t)}},getUserData:function(t){var e=context.command.valueForKey_onLayer_forPluginIdentifier("FusionCool",t,"design.fusion.cool");if(e){var n;try{n=JSON.parse("".concat(e))}catch(t){log(t)}return n||"".concat(e)}var o=r.Settings.layerSettingForKey(t,"FusionCool");return o||0},rectToJSON:function(t){var e=t.rect,n=t.referenceRect;return n?{x:Math.round(10*(e.x()-n.x()))/10,y:Math.round(10*(e.y()-n.y()))/10,width:Math.round(10*e.width())/10,height:Math.round(10*e.height())/10}:{x:Math.round(10*e.x())/10,y:Math.round(10*e.y())/10,width:Math.round(10*e.width())/10,height:Math.round(10*e.height())/10}}};t.exports=s},"./src/index.js":function(t,e,n){"use strict";n.r(e),function(t){n.d(e,"onSelectionChangedFinish",function(){return o}),n.d(e,"onCloseDocument",function(){return a}),n.d(e,"onShutdown",function(){return i}),n.d(e,"onStartup",function(){return s}),n.d(e,"onOpenDocument",function(){return c}),n.d(e,"onDebug",function(){return l});var r=n("./src/panel.js");function o(t){log("selection change finish");var e=NSThread.mainThread().threadDictionary()[t.actionContext.document];e&&e.onSelectionChanged&&e.onSelectionChanged()}function a(t){var e=NSThread.mainThread().threadDictionary(),n=t.actionContext.document;if(n){var r=e[n];if(r&&r.closeFusionCool){r.view&&r.view.evaluateJavaScript_completionHandler(NSString.stringWithFormat("%@","window.reportHealth && window.reportHealth()"),nil);try{r.closeFusionCool(),e[n].release(),e[n]=nil}catch(t){log("close FusionCool err")}}}}function i(){var t=NSDocumentController.sharedDocumentController().documents();if(t&&t.count()){var e=NSThread.mainThread().threadDictionary();t.forEach(function(t){if(t){var n=e[t];if(n&&n.closeFusionCool)try{n.closeFusionCool(),e[t].release(),e[t]=nil}catch(t){log("close FusionCool err")}}})}}function s(){var e=NSDocumentController.sharedDocumentController().documents();if(e&&e.count()){var n=NSThread.mainThread().threadDictionary();e.forEach(function(e){e&&!n[e]&&t(function(){n[e]=Object(r.default)().new().init2(e)},0)})}}function c(e){var n=NSThread.mainThread().threadDictionary(),o=e.actionContext.document;o&&!n[o]&&t(function(){n[o]=Object(r.default)().new().init2(o)},0)}function l(t){NSThread.mainThread().threadDictionary()[t.document]?i():s()}}.call(this,n("./node_modules/_@skpm_timers@0.1.0@@skpm/timers/timeout.js").setTimeout)},"./src/panel.js":function(t,e,n){"use strict";n.r(e),function(t){var r=n("sketch"),o=n.n(r),a=n("./node_modules/_cocoascript-class@0.1.2@cocoascript-class/lib/index.js"),i=n.n(a),s=n("./src/wkwebview.js"),c=n("./src/api/index.js"),l=n.n(c),u=n("./src/dialog.js"),h=n("./src/common/logger.js"),p=n.n(h),d=n("./src/common/sketch-api.js"),f=n.n(d),m=n("./src/common/sketch-layer.js"),g=n.n(m),b=n("./src/uiwebview/login.js"),S=n("./src/export/Exporter.js"),y=n.n(S);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach(function(e){j(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function j(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var x={sharedDialog:nil,document:nil,fiber:nil,api:nil,view:nil,editor:0,imagePreview:0,init2:function(e){var n=this;this.fiber=o.a.Async.createFiber(),this.document=e,this.view=Object(s.createWebview)(),this.exporter=new y.a(this.document,function(t){var e=t.type,r=t.data,o=NSString.stringWithFormat("%@","try {\n        window.onSketchEventTrigger(".concat(JSON.stringify({type:e,data:r}),");\n      } catch (err) {\n        console.error(err);\n        window.callNative('goToErrorPage');\n      }"));n.view.evaluateJavaScript_completionHandler(o,nil),o=null},function(t){var e=g.a.getLayerData("FusionCool",t);if(e){if("component"==e.type||"adaptor-component"==e.type)return w({name:e.name},e.pkgName?{lib:e.pkgName}:{});if("block"==e.type||"scaffold"==e.type)return{name:e.name,lib:e.pkgName,version:e.version,homepage:e.homepage}}return null});var r={initEditor:this.initEditor,showEditor:function(){return n.showEditor()},hideEditor:function(){return n.hideEditor()},showImagePreviewPanel:this.showImagePreviewPanel,closeImagePreviewPanel:this.closeImagePreviewPanel,dialog:function(t){var e=t.url,r=t.options;n.dialog({url:e,options:r})},showLogin:function(t){var e=t.url,r=t.options;n.showLogin({url:e,options:r})},closeDialog:this.closeDialog,stopBlocking:this.stopBlocking,callMainFrameWindowFunction:function(t){var e=t.script;n.callMainFrameWindowFunction({script:e})},notifyEditor:function(t){if(n.editor){var e="window.onSketchEventTrigger(".concat(JSON.stringify(t),")");n.editor.callMainFrameWindowFunction({script:e})}},switchTab:this.switchTab,exportToLocal:function(t){n.exporter.exportToLocal(t)},exportToDemoPlus:function(t){n.exporter.exportToDemoPlus(t)},exportToIcsZip:function(t){n.exporter.exportToIcsZip(t)},goToErrorPage:function(){var e=NSURLRequest.requestWithURL(NSURL.fileURLWithPath("".concat(l.a.getResourcePath(),"/error.html")));t(function(){n.view.loadRequest(e)},500)},reload:function(){n.loadPageURL()}};return this.api=w(w({},l.a),r),Object(s.addWebScriptHandler)(this.view,this.api),this.inject(),this.loadPageURL(),this.systemNotificationCenter(),this},loadPageURL:function(){var e=this;if(NSData.dataWithContentsOfURL(NSURL.URLWithString("https://alifd.oss-cn-hangzhou.aliyuncs.com/sketch-fusion/__magic__FusionCool__Asset__group.svg"))){var n,r=l.a.isAlibabaNet();n=r?s.config.internal_prod_mainURL:s.config.external_prod_mainURL,p.a.logInfo("loadPageURL:".concat(n));var o=NSURLRequest.requestWithURL(NSURL.URLWithString(n));this.view.loadRequest(o),this.view.evaluateJavaScript_completionHandler(NSString.stringWithFormat("%@",'window.sessionStorage.setItem("panel", "0");'),nil)}else{var a=NSURLRequest.requestWithURL(NSURL.fileURLWithPath("".concat(l.a.getResourcePath(),"/offline.html")));t(function(){e.view.loadRequest(a)},500)}},initEditor:function(t){var e=t.url;if(0==this.editor){var n=NSWindowStyleMaskTitled+NSWindowStyleMaskClosable+NSWindowStyleMaskResizable,r=this.document.documentWindow().frame(),o=Object(u.default)().alloc().initWithContentRect_styleMask_backing_defer(NSMakeRect(r.size.width-240-240+r.origin.x,r.origin.y,240,r.size.height-76),n,NSBackingStoreBuffered,!0);this.editor=o,o.init3(e,this.api),o.autorelease()}return 1},showEditor:function(){if(0!=this.editor&&0==this.editor.isVisible()){var t=this.document.documentWindow().frame(),e=NSMakeRect(t.size.width-240-240+t.origin.x,t.origin.y,240,t.size.height-76);this.editor.setFrame_display(e,1),this.document.documentWindow().addChildWindow_ordered(this.editor,NSWindowAbove),this.editor.setIsVisible(1)}return 1},hideEditor:function(){return 0!=this.editor&&1==this.editor.isVisible()&&this.editor.setIsVisible(0),1},showImagePreviewPanel:function(t){var e=t.url,n=t.clientY;0!=this.imagePreview&&this.imagePreview.close();var r=NSData.dataWithContentsOfURL(NSURL.URLWithString(e));if(r){var o=NSImage.alloc().initWithData(r),a=o.size(),i=a.width,s=a.height;if(a.width>720||a.height>416){var c=a.width/a.height;c>2?(i=720,s=720/c):(s=416,i=416*c)}var l=NSImageView.alloc().initWithFrame(NSMakeRect(10,10,i,s));l.setImage(o);var u=NSWindowStyleMaskUnifiedTitleAndToolbar,h=this.document.documentWindow().frame(),p=NSWindow.alloc().initWithContentRect_styleMask_backing_defer(NSMakeRect(h.size.width-240-i-20+h.origin.x,h.origin.y+Math.max(n-(s+20),0),i+20,s+20),u,NSBackingStoreBuffered,!0);p.contentView().addSubview(l),this.imagePreview=p,this.document.documentWindow().addChildWindow_ordered(p,NSWindowAbove),p.autorelease()}else log("Fetch image failed.")},closeImagePreviewPanel:function(){0!=this.imagePreview&&(this.imagePreview.close(),this.imagePreview=0)},dialog:function(t){var e=t.url,n=t.options,r={width:n.width||400,height:n.height||300,resizable:n.resizable||!1},o=NSWindowStyleMaskTitled+NSWindowStyleMaskClosable;r.resizable&&(o=NSWindowStyleMaskResizable+o);var a=Object(u.default)().alloc().initWithContentRect_styleMask_backing_defer(NSMakeRect(0,0,r.width,r.height),o,NSBackingStoreBuffered,!0);return this.sharedDialog=a,a.init2(e,this.api),NSApplication.sharedApplication().runModalForWindow(a),a.autorelease(),1},showLogin:function(t){var e=t.url,n=t.options,r={width:n.width||100,height:n.height||600,resizable:n.resizable||!1},o=NSWindowStyleMaskTitled+NSWindowStyleMaskClosable;r.resizable&&(o=NSWindowStyleMaskResizable+o);var a=Object(b.default)().alloc().initWithContentRect_styleMask_backing_defer(NSMakeRect(0,0,r.width,r.height),o,NSBackingStoreBuffered,!0);return a.init2(e),a.setSuperView(this.view),NSApplication.sharedApplication().runModalForWindow(a),a.autorelease(),1},closeDialog:function(){return this.sharedDialog&&this.sharedDialog.stop&&(this.sharedDialog.stop(),this.sharedDialog=nil),1},stopBlocking:function(){return this.sharedDialog&&this.sharedDialog.stopBlocking&&this.sharedDialog.stopBlocking(),1},systemNotificationCenter:function(){NSDistributedNotificationCenter.defaultCenter().addObserver_selector_name_object(this,NSStringFromSelector("onAppearanceChanged"),NSString.stringWithString("AppleInterfaceThemeChangedNotification"),nil)},onAppearanceChanged:function(){var e=this;t(function(){var t={type:"onAppearanceChanged",data:{theme:e.api.appearance()}};if(e.nativeView&&e.nativeView.color&&"MSInspectorBackgroundView"==e.nativeView.class()&&e.stackView&&e.stackView.setBackgroundColor){var n=e.nativeView.color();e.stackView.setBackgroundColor(n)}var r="window.onSketchEventTrigger(".concat(JSON.stringify(t),")");e.callMainFrameWindowFunction({script:r})},1e3)},inject:function(){for(var t,e,n=this.document.documentWindow().contentView().subviews().objectAtIndex(0),r=n.subviews().count()-1;r>0&&(t=n.subviews().objectAtIndex(r),r+=1,"NSStackView"!=(e=t.subviews().objectAtIndex(0)).class()););this.stackView=e,e.spacing=8,e.alignment=NSLayoutAttributeCenterX;var o=e.subviews()[1],a=o.frame().size.width;if(this.nativeView=o,"MSInspectorBackgroundView"==o.class())e.setWantsLayer(!0),e.setBackgroundColor(o.color());else{var i=NSColor.colorWithDeviceRed_green_blue_alpha(236/255,236/255,236/255,1);this.view.setBackgroundColor(i)}e.removeView(o);var s=NSTabView.new();s.tabViewType=NSNoTabsNoBorder;var c=NSTabViewItem.new(),u=NSBundle.mainBundle().infoDictionary().CFBundleShortVersionString.UTF8String();if(u&&+u<52){var h=NSStackView.new();h.insertView_atIndex_inGravity(o,0,NSStackViewGravityTop),c.view=h}else c.view=o;var p=NSTabViewItem.new();p.view=this.view,s.addTabViewItem(c),s.addTabViewItem(p),s.widthAnchor().constraintEqualToConstant(a).active=!0,this.tabView=s,e.insertView_atIndex_inGravity(s,1,NSStackViewGravityTop);var d=NSSegmentedControl.new();d.segmentStyle=NSSegmentStyleRounded,d.segmentCount=2;var f=NSImage.new().initWithContentsOfFile("".concat(l.a.getResourcePath(),"/sketch.png")),m=NSImage.new().initWithContentsOfFile("".concat(l.a.getResourcePath(),"/fusion.png"));f.template=!0,m.template=!0,d.setImage_forSegment(f,0),d.setImage_forSegment(m,1),d.setImageScaling_forSegment(NSImageScaleProportionallyDown,0),d.setImageScaling_forSegment(NSImageScaleProportionallyDown,1),d.setWidth_forSegment(28,0),d.setWidth_forSegment(28,1),d.heightAnchor().constraintEqualToConstant(24).setActive(1),d.setSelected_forSegment(!0,0),d.setTarget(this),d.subviews()[0].setToolTip("Sketch"),d.subviews()[1].setToolTip("FusionCool"),d.setAction(NSStringFromSelector("onSegmentTabChange")),e.insertView_atIndex_inGravity(d,1,NSStackViewGravityTop),this.segc=d},onSegmentTabChange:function(t){var e=t.selectedSegment();this.tabView.selectTabViewItemAtIndex(e),1==e&&this.view&&this.view.evaluateJavaScript_completionHandler(NSString.stringWithFormat("%@",'window.sessionStorage.setItem("panel", "1");'),nil)},switchTab:function(t){this.tabView.selectTabViewItemAtIndex(t),this.segc.setSelected_forSegment(!0,t)},onSelectionChanged:function(){if(!l.a.handlerSvgMagicRules()){log("webview will get selection change action");var t=[];f.a.getLayer()&&(t=l.a.getSketchSelections());var e={type:"onSelectionChange",data:t},n="window.onSketchEventTrigger(".concat(JSON.stringify(e),")");this.callMainFrameWindowFunction({script:n})}},closeFusionCool:function(){var t=this.stackView,e=this.nativeView,n=this.view;if(e&&n)if(t&&t.subviews&&3===t.subviews().count()){var r=t.subviews(),o=r[0],a=r[1],i=r[2],s=o.frame().size,c=a.frame().size,l=t.frame().size,u=l.height-s.height,h=l.height-s.height-c.height;t.spacing=0,o.removeFromSuperview(),a.removeFromSuperview(),i.removeFromSuperview(),n.stopLoading(),n.configuration().userContentController().removeAllUserScripts(),n.release(),this.view=null,o.widthAnchor().constraintEqualToConstant(l.width).setActive(1),o.heightAnchor().constraintEqualToConstant(s.height).setActive(1),e.widthAnchor().constraintEqualToConstant(l.width).setActive(1),e.heightAnchor().constraintEqualToConstant(u).setActive(1),t.addArrangedSubview(o),t.addArrangedSubview(e),e.heightAnchor().constraintEqualToConstant(u-h).setActive(1),NSDistributedNotificationCenter.defaultCenter().removeObserver(this),this.fiber&&this.fiber.cleanup&&this.fiber.cleanup()}else log("closeFusionCool: no subviews");else log("closeFusionCool: no webview")},openExportDialog:function(){this.callMainFrameWindowFunction({script:"try {\n      window.FusionCool.openExportDialog();\n    } catch(err) {}"})},callMainFrameWindowFunction:function(t){var e=t.script,n=NSString.stringWithFormat("%@","try {\n      ".concat(e,"\n    } catch (err) {\n      console.error(err);\n      window.callNative('goToErrorPage');\n    }"));this.view.evaluateJavaScript_completionHandler(n,nil),n=null}};e.default=function(){return i()(x)}}.call(this,n("./node_modules/_@skpm_timers@0.1.0@@skpm/timers/timeout.js").setTimeout)},"./src/uiwebview/login.js":function(t,e,n){"use strict";n.r(e);var r=n("./node_modules/_cocoascript-class@0.1.2@cocoascript-class/lib/index.js"),o=n.n(r),a=n("./src/uiwebview/wrap.js"),i={className:"FCLoginDialog",superclass:WebView,init:function(){this.drawsBackground=!1,this.shouldCloseWithWindow=!0,this.setFrameLoadDelegate(this)},init2:function(t){this._nspanel=t},"webView:didCreateJavaScriptContext:forFrame:":function(t){try{t.windowScriptObject().setValue_forKey(Object(a.default)({testKey:"fusioncool-test",loginSuccess:function(){t._nspanel.loginSuccess()},stop:function(){t._nspanel.stop()},stopBlocking:function(){t._nspanel.stopBlocking()}}),"FCLogin")}catch(t){log(t)}}},s={className:"FCLoginWindow",superclass:NSWindow,init2:function(t){return this.standardWindowButton(NSWindowMiniaturizeButton).setHidden(!0),this.standardWindowButton(NSWindowZoomButton).setHidden(!0),this.setDelegate(this),this.viewInit(t),this},setSuperView:function(t){this.superView=t},callSuperView:function(t){if(this.superView){var e=NSString.stringWithFormat("%@","try {\n      ".concat(t,"\n    } catch (err) { console.error(err);}"));this.superView.evaluateJavaScript_completionHandler(e,nil)}},viewInit:function(t){var e=o()(i).new();e.init2(this);var n=this.contentView();e.setAutoresizingMask(NSViewWidthSizable+NSViewHeightSizable),e.setFrame(n.bounds()),n.addSubview(e),e.setMainFrameURL(t),this.view=e},stopBlocking:function(){NSApplication.sharedApplication().stopModal()},loginSuccess:function(){this.callSuperView("window.FusionCool.getLoginStatusAndThemes()"),this.stop()},stop:function(){this.view&&this.view.close&&this.view.close(),this.stopBlocking(),this.close()},"windowWillClose:":function(){this.stopBlocking()}};e.default=function(){return o()(s)}},"./src/uiwebview/wrap.js":function(t,e,n){"use strict";n.r(e);var r=n("./node_modules/_cocoascript-class@0.1.2@cocoascript-class/lib/index.js"),o=n.n(r);function a(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var s=Array.prototype.slice;function c(t){var e=t;return t.isKindOfClass(NSString.class())?e="".concat(t):t.isKindOfClass(NSNumber.class())?e=t+0:t.isKindOfClass(NSDictionary.class())?(e={},Object.keys(t).forEach(function(n){e[n]=c(t[n])})):t.isKindOfClass(NSArray.class())&&(e=[],t.forEach(function(t){e.push(c(t))})),e}function l(t){if("WebScriptObject"==t.class()){var e=t.JSValue();return e.hasProperty("call")?function(){t.callWebScriptMethod_withArguments("call",[null].concat(s.call(arguments)).map(h))}:e.isArray()?c(e.toArray()):c(e.toDictionary())}return c(t)}var u=o()({className:"FCWrapper","invokeDefaultMethodWithArguments:":function(t){var e,n=this.core;if("function"==typeof n){var r=s.call(t).map(l);e=n.apply(void 0,a(r))}return h(e)},"invokeUndefinedMethodFromWebScript:withArguments:":function(t,e){var n,r=this.core;return(t+="")in r&&"_"!==t[0]&&(e=s.call(e).map(l),"function"==typeof r[t]?n=r[t].apply(r,a(e)):e[0]?r[t]=e[0]:n=r[t]),h(n)}});function h(t){switch(Object.prototype.toString.call(t)){case"[object String]":return NSString.stringWithString(t);case"[object Object]":case"[object Function]":var e=u.new();return e.core=t,e;case"[object Null]":case"[object Undefined]":return null;case"[object Array]":return NSArray.arrayWithArray(t.map(h));default:return t}}e.default=h},"./src/wkwebview.js":function(t,e,n){"use strict";n.r(e),function(t){n.d(e,"config",function(){return l}),n.d(e,"createWebview",function(){return u}),n.d(e,"addWebScriptHandler",function(){return h});var r=n("./node_modules/_cocoascript-class@0.1.2@cocoascript-class/lib/index.js"),o=n.n(r),a=n("./src/api/index.js"),i=n.n(a);function s(t){"@babel/helpers - typeof";return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var c="\n  if (!window.callNative) {\n    console.log('A2::Inject JSAPI-2.0.0');\n    window.callNative = async (apiName, apiParam) => {\n      if (!(\n        window.webkit &&\n        window.webkit.messageHandlers &&\n        window.webkit.messageHandlers.FusionCoolMessageCenter &&\n        window.webkit.messageHandlers.FusionCoolMessageCenter.postMessage)) {\n          return false;\n      }\n      const random = [\n        +new Date(),\n        parseInt(Math.random()*1000000000, 10),\n      ].join('_');\n      const callbackKey = 'FusionCool_callback_' + random;\n      window.webkit.messageHandlers.FusionCoolMessageCenter.postMessage({\n        name: apiName,\n        param: apiParam,\n        fn: callbackKey,\n      });\n      return await new Promise((resolve) => {\n        window[callbackKey] = (res) => {\n          resolve(res);\n          window[callbackKey] = null;\n          delete window[callbackKey];\n        };\n      });\n    };\n  }\n",l={JSBRIDGE_NAME:"FusionCoolMessageCenter",internal_prod_mainURL:"https://fusion.alibaba-inc.com".concat("/plugin/cool"),internal_pre_mainURL:"https://pre-fusion.alibaba-inc.com".concat("/plugin/cool"),external_prod_mainURL:"https://fusion.design".concat("/plugin/cool"),external_pre_mainURL:"https:///pre-www.fusion.design".concat("/plugin/cool")},u=function(){var e=WKWebViewConfiguration.alloc().init();e.preferences().setValue_forKey(1,"developerExtrasEnabled");var n=WKWebView.alloc().initWithFrame_configuration(CGRectMake(0,0,300,600),e);n.setValue_forKey(!1,"drawsBackground");var r={"webView:didStartProvisionalNavigation:":function(t){log("1::webView:didStartProvisionalNavigation:"),t.evaluateJavaScript_completionHandler(c,nil)},"webView:didCommitNavigation:":function(t){log("2::webView:didCommitNavigation:"),t.evaluateJavaScript_completionHandler(c,nil)},"webView:didFinishNavigation:":function(e){if(log("3::webView:didFinishNavigation:"),e.evaluateJavaScript_completionHandler(c,nil),"about:blank"==e.URL()){var n=i.a.isAlibabaNet()?l.internal_prod_mainURL:l.external_prod_mainURL,r=NSURLRequest.requestWithURL(NSURL.URLWithString(n));e.loadRequest(r),t(function(){e.evaluateJavaScript_completionHandler('console.error("about blank error")',nil)},1e3)}},"webView:didReceiveServerRedirectForProvisionalNavigation:":function(t){log("4::webView:didReceiveServerRedirectForProvisionalNavigation:"),t.evaluateJavaScript_completionHandler(c,nil)},"webViewWebContentProcessDidTerminate:":function(){log("5::wkwebview 进程终止")}};return n.navigationDelegate=o()(r).new(),n},h=function(t,e){var n={"userContentController:didReceiveScriptMessage:":function(n,r){var o,a=NSJSONSerialization.dataWithJSONObject_options_error(r.body(),0,null),i=NSString.alloc().initWithData_encoding(a,NSUTF8StringEncoding),c=JSON.parse("".concat(i));if(c.param&&"string"==typeof c.param&&/^[{[]/.test(c.param))try{c.param=JSON.parse(c.param)}catch(t){}switch(s(o=e[c.name]?c.param?e[c.name](c.param):e[c.name]():"[ERROR] API Not Found: ".concat(c.name))){case"undefined":o="";break;case"string":case"object":o=JSON.stringify(o)}var l=NSString.stringWithFormat("window.%@(%@)",c.fn,o);l="try { ".concat(l,"; } catch(err) { console.error(err); }"),t.evaluateJavaScript_completionHandler(l,nil)}};t.configuration().userContentController().addScriptMessageHandler_name(o()(n).new(),l.JSBRIDGE_NAME)}}.call(this,n("./node_modules/_@skpm_timers@0.1.0@@skpm/timers/timeout.js").setTimeout)},events:function(t,e){t.exports=require("events")},sketch:function(t,e){t.exports=require("sketch")}});"default"===key&&"function"==typeof exports?exports(context):exports[key](context)}that.onSelectionChangedFinish=__skpm_run.bind(this,"onSelectionChangedFinish"),that.onCloseDocument=__skpm_run.bind(this,"onCloseDocument"),that.onOpenDocument=__skpm_run.bind(this,"onOpenDocument"),that.onStartup=__skpm_run.bind(this,"onStartup"),that.onShutdown=__skpm_run.bind(this,"onShutdown"),that.onRun=__skpm_run.bind(this,"default"),that.onDebug=__skpm_run.bind(this,"onDebug");