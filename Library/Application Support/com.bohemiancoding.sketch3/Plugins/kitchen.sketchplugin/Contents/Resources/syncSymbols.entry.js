!function(e){function t(t){for(var a,c,i=t[0],l=t[1],s=t[2],p=0,m=[];p<i.length;p++)c=i[p],Object.prototype.hasOwnProperty.call(r,c)&&r[c]&&m.push(r[c][0]),r[c]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(u&&u(t);m.length;)m.shift()();return o.push.apply(o,s||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,i=1;i<n.length;i++){var l=n[i];0!==r[l]&&(a=!1)}a&&(o.splice(t--,1),e=c(c.s=n[0]))}return e}var a={},r={9:0},o=[];function c(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=a,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(n,a,function(t){return e[t]}.bind(null,a));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="";var i=window.webpackJsonp=window.webpackJsonp||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var s=0;s<i.length;s++)t(i[s]);var u=l;o.push([579,0]),n()}({0:function(e,t){e.exports=React},129:function(e,t,n){e.exports={repo:"_33MUNPFiXVdLywChLoshtX",title:"_2UuUJzZktE9jAw9mvBtxEe",avatar:"_1epyZ2BwJQEagedGHQ849x",icon:"_3-xWe6EejUsixLZF4XXDR"}},151:function(e,t,n){e.exports={assetcard:"_16QnWkRCZVrDLUwIhBBWMP",content:"_1iOrl99SvZ5VTZ8Ko0TB2B",avatar:"Bl_Wjd7Hclpgv79waLHFI",divider:"_28Kbq3Dquogd2kUZhi2HDO",isNew:"XWj_2bf9yEDLFUTXuQ40L",actions:"_2zAZhJ5fc_KSKLAHjmPX6F",pending:"_2ZgKBbIylAwMCZMQqd1MU7"}},152:function(e,t,n){e.exports={header:"_3-jVOyU5Akz_aeAYDyXrTE",title:"_2EzI0Hg-NfRMafMyVX6mii",actions:"Yy0CPK--1-QoObU0pgiDz",images:"_2QNzd4gXq9Bx1ch2_ZxDv9",back:"_2RWnEXSwHvlAfqDxJpxceI"}},153:function(e,t,n){e.exports={cards:"_3acDvK3PmCX4oztxTTpy1p",card:"_2KP-UC-9V3oR9ByDBh3rtB",avatar:"_3P75jdazNrlGBw-t1ODYrH",title:"_1li_hVhDtL3HrWqvCHFCie",repo:"_2beaoO7tzdpOAQwvrEtj3o"}},263:function(e,t,n){e.exports={repos:"_1qwja-y70_zJ5oaK7BfpOc"}},344:function(e,t,n){e.exports={repoSwitch:"_3t97gV6nh0W9KYXfRxjKQS"}},345:function(e,t,n){e.exports={groups:"_2bcsqh3WctSiUnY3vuYFEu"}},579:function(e,t,n){e.exports=n(718)},718:function(e,t,n){"use strict";n.r(t);var a=n(29),r=n.n(a),o=n(0),c=n.n(o),i=n(8),l=n.n(i),s=n(26),u=n.n(s),p=n(216),m=n(47),d=(n(137),n(79)),f=(n(46),n(18)),g=(n(123),n(42)),y=(n(138),n(39)),b=(n(49),n(21)),E=(n(31),n(5)),v=(n(54),n(28)),h=n(33),w=n.n(h),k=n(41),O=n.n(k),C=n(1),_=n.n(C),S=n(4),N=n.n(S),x=n(80),j=n(347),I=n.n(j),R=(n(179),n(91)),L=(n(163),n(72)),D=n(108),U=n.n(D),P=(n(106),n(58)),A=(n(585),n(220)),B=(n(107),n(34)),F=n(344),T=n.n(F),V=B.a.Option,K=function(e){var t=e.name,n=e.user,a=e.slug,r=e.id,i=e.className,l=e.repos,s=void 0===l?[]:l,u=e.onRepoChange,p=Object(o.useContext)(et),m=p.pluginCall,d=p.LARK_BASE_URL,f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"".concat(d,"/").concat(e,"/").concat(t)},g=s.length>0;return c.a.createElement(A.a,{style:{display:"inline-block"},className:i},c.a.createElement(A.a.Item,{onClick:function(){return m("open",[f(n.login)])}},c.a.createElement("a",null,n.name)),c.a.createElement(A.a.Item,{onClick:function(){return!g&&m("open",[f(n.login,a)])}},g?c.a.createElement(B.a,{defaultValue:r,dropdownStyle:{maxHeight:250,overflow:"auto"},dropdownMatchSelectWidth:!1,getPopupContainer:function(e){return e.parentNode},onChange:u,className:T.a.repoSwitch},s.map((function(e){return c.a.createElement(V,{key:e.id,value:e.id},e.name)}))):c.a.createElement("a",null,t)))},z=(n(254),n(101)),M=(n(40),n(13)),W=["#1890ff","#36CDC7","#9254DE","#F759AC","#FF7A45","#FFA940","#1D1D1D","#2F54EB"];function X(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.split("").reduce((function(e,t){return t.charCodeAt(0)+e}),0)%W.length;return W[t]}var Y=n(95),q=n.n(Y),H=c.a.memo((function(e){var t,n=e.name,a=void 0===n?"":n,r=e.repo,i=e.id,l=e.onImport,s=e.onExport,u=e.hide,p=e.isNew,m=e.showFeedBack,d=e.showRepo,g=void 0===d||d,y=Object(o.useContext)(et),h=y.dispatch,w=y.importingOrExporting,k=y.newSymbol,O=y.importedLibraries,C=y.pluginCall,_=y.LARK_BASE_URL,S=Object(o.useCallback)((function(){i&&(i.toString().startsWith("NEW_")?M.a.info("你可能刚刚上传这个资源，请刷新列表后再试"):h({type:"changeCurrentSymbol",payload:{repoId:r.id,groupId:i}}))})),x=!(!w.percent||w.success||w.fail||w.groupId!==i),j=Object(o.useRef)(),I=O.find((function(e){return e.name===a}));return Object(o.useEffect)((function(){p&&j.current&&j.current.select&&(j.current.focus(),j.current.select())}),[]),t=p?c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a,{title:"同步当前文件 Symbols 到语雀",placement:"bottom"},c.a.createElement(f.a,{type:"primary",style:{marginRight:8},onClick:s,loading:x},"确定上传")),c.a.createElement(f.a,{onClick:function(){return h({type:"cancelCreateNewSymbol"})}},"取消")):i?c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a,{title:"用当前文件 Symbol 覆盖此模板",mouseLeaveDelay:0},c.a.createElement(E.a,{type:x&&"export"===w.type?"loading":"upload",style:{pointerEvents:x&&"export"===w.type?"none":""},onClick:s})),c.a.createElement(z.a,{type:"vertical",style:{background:"#f0f0f0"}}),c.a.createElement(b.a,{title:I?"已导入":"导入",mouseLeaveDelay:0},c.a.createElement(E.a,{type:x&&"import"===w.type?"loading":"import",style:{pointerEvents:x&&"export"===w.type?"none":"",color:I?"#ccc":"",cursor:I?"not-allowed":""},onClick:I?null:l})),m&&c.a.createElement(c.a.Fragment,null,c.a.createElement(z.a,{type:"vertical",style:{background:"#f0f0f0"}}),c.a.createElement(b.a,{title:"反馈问题",mouseLeaveDelay:0},c.a.createElement(E.a,{type:"issues-close",onClick:function(){return C("open",["".concat(_,"/").concat(r.user.login,"/topics")])}})))):c.a.createElement("div",{className:q.a.pending},"已上传"),c.a.createElement("div",{className:N()(q.a.card,{[q.a.isNew]:p}),onClick:S,style:{display:u?"none":""}},c.a.createElement("div",{className:q.a.content},c.a.createElement(P.a,{size:48,className:q.a.avatar,style:{background:X(a)}},a.substring(0,2)),p?c.a.createElement(v.a,{value:k.name,className:q.a.input,ref:j,onChange:function(e){h({type:"changeNewSymbol",payload:{name:e.target.value}})}}):c.a.createElement("h3",null,a),g?c.a.createElement(K,{name:r.name,slug:r.slug,user:r.user,className:q.a.repo}):null,c.a.createElement(z.a,{className:q.a.divider}),c.a.createElement("div",{className:q.a.actions,onClick:function(e){e.stopPropagation()}},t)))})),J=n(345),G=n.n(J),Z=c.a.memo((function(e){var t=e.loading,n=e.groups,a=void 0===n?[]:n,r=e.repo,i=e.showFeedBack,l=e.showRepo,s=Object(o.useContext)(et),u=s.onImport,p=s.onExport,m=s.searchValue,d=void 0===m?"":m,f=s.newSymbol,g=Object(o.useCallback)((function(){p({repoId:r.id,currentDocumentName:f&&f.name})}),[r,f]);if(t)return c.a.createElement(L.a,{active:!0});var y=a.filter((function(e){return"symbol"===e.artboard_type}));return 0!==y.length||d.trim()||f?c.a.createElement("div",{className:G.a.groups},y.map((function(e){return c.a.createElement(H,{name:e.name,key:e.id||"new",id:e.id||e.name,repo:e.parentRepo,onImport:function(){return u(e)},onExport:function(){return p({groupId:e.id,repoId:e.parentRepo.id})},showFeedBack:i,showRepo:l})})),f&&f.repoId===r.id?c.a.createElement(H,{key:"new",name:f.name,repo:r,isNew:!0,onExport:g,showRepo:!1}):null):c.a.createElement(R.a,{image:"https://gw.alipayobjects.com/zos/antfincdn/SlE6YUVYrp/1.svg",imageStyle:{height:24,marginBottom:12},style:{height:200,borderRadius:4,background:"rgba(0, 0, 0, .02)",paddingTop:62,color:"rgba(0, 0, 0, .25)"},description:c.a.createElement("div",null,"暂时还没有 Symbol 哦")})})),Q=n(129),$=n.n(Q),ee=n(9),te=n.n(ee),ne=n(10),ae=n.n(ne),re=n(3),oe=n.n(re),ce=n(11),ie=n.n(ce),le=n(12),se=n.n(le),ue=n(6),pe=n.n(ue),me=n(2),de=n.n(me),fe=n(151),ge=n.n(fe),ye=n(14);function be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=pe()(e);if(t){var r=pe()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return se()(this,n)}}window.assetCheckResultMessenger=function(){},window.pluginCall=ye.a;var Ee=function(e){ie()(n,e);var t=be(n);function n(e){var a;return te()(this,n),a=t.call(this,e),de()(oe()(a),"onCheck",(function(){var e,t=a.props.name;(e=t,new Promise((function(t){window.assetCheckResultMessenger=t,Object(ye.a)("getAssetCheckResult",[e])}))).then((function(e){console.log(e);var t=JSON.parse(e),n=t.valid,r=t.errors;a.setState({isValid:n}),n?M.a.success("资产源文件格式校验通过，可以上传更新。",5):d.a.error({title:"资产源文件格式存在以下可能的错误：",content:c.a.createElement("div",null,c.a.createElement("ul",{style:{paddingLeft:24}},r.map((function(e){return c.a.createElement("li",null,e.info,c.a.createElement(E.a,{type:"question-circle",theme:"twoTone",onClick:function(){Object(ye.a)("open",[e.ref])}}))}))),c.a.createElement("p",null,"请尝试修改以上格式错误后重试。"))})}))})),de()(oe()(a),"forbidUpload",(function(){M.a.error("请先点击🔒进行格式校验!")})),a.state={isValid:!1},a}return ae()(n,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.onExport,a=this.state.isValid;return c.a.createElement("div",{className:ge.a.assetcard},c.a.createElement("div",{className:ge.a.content},c.a.createElement(P.a,{size:48,className:ge.a.avatar,style:{background:"red"}},t.substring(0,2)),c.a.createElement("h3",{style:{color:"#fff"}},t),c.a.createElement("span",{style:{color:"red"}},a?"格式校验通过，上传前勿再修改！":"注意！这是一个设计资产！"),c.a.createElement(z.a,{className:ge.a.divider}),c.a.createElement("div",{className:ge.a.actions,onClick:function(e){e.stopPropagation()}},c.a.createElement(b.a,{title:"通过格式校验才能上传",mouseLeaveDelay:0},c.a.createElement(E.a,{type:a?"unlock":"lock",theme:"filled",style:{color:a?"grey":"red",pointerEvents:a?"none":"",cursor:a?"not-allowed":""},onClick:a?null:this.onCheck})),c.a.createElement(z.a,{type:"vertical",style:{background:"#682626"}}),c.a.createElement(b.a,{title:"更新到线上！用户端会同步改变！",mouseLeaveDelay:0},c.a.createElement(E.a,{type:"upload",style:{color:a?"red":"grey",cursor:a?"":"not-allowed"},onClick:a?n:this.forbidUpload})))))}}]),n}(c.a.Component),ve=n(210).a.ASSET_WHITE_LIST;function he(e){var t=e.repo,n=e.repos,a=e.onRepoChange,r=e.onReload,i=e.onNewSymbol,l=Object(o.useContext)(et).onExport,s=t.name,u=t.slug,p=t.user,m=t.id,d=t.groups,f=t.loading,g=!!n;return c.a.createElement("div",{className:$.a.repo},c.a.createElement("div",{className:$.a.title},c.a.createElement("div",null,c.a.createElement(P.a,{className:$.a.avatar,size:18,src:p.avatar_url}),c.a.createElement(K,{name:s,slug:u,user:p,id:m,repos:n,onRepoChange:a,showSelect:g})),c.a.createElement("div",null,c.a.createElement(b.a,{title:"刷新"},c.a.createElement(E.a,{type:"reload",className:$.a.icon,onClick:function(){return r(m)}})),c.a.createElement(b.a,{title:"上传 Symbol 到语雀"},c.a.createElement(E.a,{type:"plus",className:$.a.icon,onClick:function(){return i(m)}})))),ve.find((function(e){return e.repoId==="".concat(m)}))?c.a.createElement("div",{className:$.a.groups},c.a.createElement(Ee,{name:s,onExport:function(){return l({repoId:m,groupId:ve.find((function(e){return e.repoId==="".concat(m)})).groupIds[0]})}})):c.a.createElement(Z,{groups:d,loading:f,repo:t,showRepo:!1}))}var we=n(263),ke=n.n(we);var Oe=function(){var e=Object(o.useContext)(et),t=e.repos,n=e.dispatch,a=e.onReload,r=e.searchValue,i=void 0===r?"":r,l=e.pluginCall,s=e.LARK_BASE_URL,u=Object(o.useState)(),p=O()(u,2),m=p[0],d=p[1],f=function(e){n({type:"createSymbol",payload:{repoId:e}})},g=Object(o.useCallback)((function(e){d(e)}));if(!t)return c.a.createElement(c.a.Fragment,null,c.a.createElement(L.a,{active:!0}),c.a.createElement(L.a,{active:!0}),c.a.createElement(L.a,{active:!0}));if(0===t.length)return c.a.createElement(R.a,{image:"https://gw.alipayobjects.com/zos/antfincdn/SlE6YUVYrp/1.svg",imageStyle:{height:24,marginBottom:12},style:{height:200,borderRadius:4,background:"rgba(0, 0, 0, .02)",paddingTop:62,color:"rgba(0, 0, 0, .25)"},description:c.a.createElement(c.a.Fragment,null,c.a.createElement("div",null,"你还没有语雀画板仓库"),c.a.createElement("div",null,"点击这里去",c.a.createElement("a",{href:"#",onClick:function(){return l("open",["".concat(s,"/new?type=Design")])}},"添加一个")))});var y=U()(t,(function(e){return e.user.id})),b=!!i.trim(),E=Object.keys(y).map((function(e){return y[e]})).reduce((function(e,t){return e.concat(t)}),[]);return b?c.a.createElement("div",{className:ke.a.repos},E.map((function(e){return 0===e.groups.filter((function(e){return"symbol"===e.artboard_type&&(e.name||"").toUpperCase().indexOf(i.toUpperCase())>=0})).length?null:c.a.createElement(he,{key:e.id,repo:e,onReload:a,onNewSymbol:f})}))):c.a.createElement("div",{className:ke.a.repos},Object.keys(y).map((function(e){var t=y[e],n=t.find((function(e){return e.id===m}))||function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.find((function(e){return e.groups&&e.groups.some((function(e){return"symbol"===e.artboard_type}))}))||e[0]}(t);return c.a.createElement(he,{key:n.id,repo:n,repos:t,onRepoChange:g,onReload:a,onNewSymbol:f})})))},Ce=(n(194),n(114)),_e=(n(193),n(55)),Se=n(264),Ne=n.n(Se),xe=n(152),je=n.n(xe),Ie=function(e){var t=e.group,n=e.repo,a=e.onBack,r=e.onStar,i=Object(o.useState)(!1),l=O()(i,2),s=l[0],p=l[1],m=Object(o.useState)([]),d=O()(m,2),g=d[0],y=d[1],v=Object(o.useContext)(et),h=v.importingOrExporting,w=void 0===h?{}:h,k=v.onImport,C=v.importedLibraries,_=v.pluginCall;Object(o.useEffect)((function(){p(!0),u.a.get("/api/v2/artboards?book_id=".concat(n.id.toString().replace("SELECTED-",""))).then((function(e){var n=(e.data.data||[]).find((function(e){return e.id===t.id||(e.artboards||[]).some((function(e){return e.asset_id===t.id}))}))||[];y(n?n.artboards:[]),p(!1)}))}),[]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a,{title:"返回列表"},c.a.createElement(E.a,{type:"left",className:je.a.back,onClick:a})),c.a.createElement("div",{className:je.a.header},c.a.createElement("div",{className:je.a.title},c.a.createElement(P.a,{size:56,style:{float:"left",background:X(t.name),marginRight:16}},t.name[0]+t.name[1]),c.a.createElement("div",{style:{overflow:"hidden"}},c.a.createElement("h2",null,t.name),c.a.createElement(K,n),c.a.createElement(b.a,{title:Ne()(t.updated_at).format("YYYY-MM-DD HH:mm:ss")},c.a.createElement("span",{style:{marginLeft:20}},"更新时间：",Ne()(t.updated_at).fromNow())))),c.a.createElement("div",{className:je.a.actions},c.a.createElement(b.a,{title:"敬请期待"},c.a.createElement(f.a,{onClick:function(){return r(t.id)},disabled:!0},c.a.createElement(E.a,{type:"heart"}),"收藏")),function(){var e=!(!w.percent||w.success||w.fail||w.groupId!==t.id);if(C.find((function(e){return e.name===t.name})))return c.a.createElement(Ce.a.Button,{overlay:c.a.createElement(_e.a,{onClick:function(){return k(t)}},c.a.createElement(_e.a.Item,null,c.a.createElement(E.a,{type:"reload",style:{color:x.gold[5]}}),"重新导入")),style:{marginLeft:8},onClick:function(){return _("showLibrariesPane")}},c.a.createElement(E.a,{type:"check",style:{color:x.green.primary}}),"已导入");var n="导入";return w.message&&"import"===w.type&&(n="".concat(w.message," ").concat(w.percent,"%")),c.a.createElement(f.a,{type:"primary",onClick:function(){return k(t)},loading:e,icon:"import"},n)}())),c.a.createElement("div",{className:je.a.images},s?c.a.createElement(L.a,{active:!0}):g.map((function(e){return c.a.createElement("img",{alt:"预览图片",key:e.image,src:e.image})}))))},Re=n(153),Le=n.n(Re),De=function(){var e=Object(o.useContext)(et),t=e.selected,n=e.dispatch;if(!t)return c.a.createElement(c.a.Fragment,null,c.a.createElement(L.a,{active:!0}),c.a.createElement(L.a,{active:!0}),c.a.createElement(L.a,{active:!0}));if(!t||!t.groups)return null;var a=t.groups,r=void 0===a?[]:a;return c.a.createElement("div",{className:Le.a.cards},r.map((function(e){return c.a.createElement("div",{key:e.id,className:Le.a.card,onClick:function(){return a={repoId:t.id,groupId:e.id},r=a.repoId,o=a.groupId,void n({type:"changeCurrentSymbol",payload:{repoId:r,groupId:o}});var a,r,o}},c.a.createElement("div",{style:{background:X(e.name)}},c.a.createElement("div",{className:Le.a.avatar},c.a.createElement(P.a,{size:48,style:{background:"#fff",color:X(e.name)}},e.name[0]+e.name[1])),c.a.createElement("div",{className:Le.a.title},e.name),c.a.createElement(K,{name:t.name,slug:t.slug,user:t.user,className:Le.a.repo})))})))},Ue=function(){var e=Object(o.useContext)(et),t=e.repos,n=e.importedLibraries,a=e.searchValue,r=void 0===a?"":a,i=t.map((function(e){return e.groups})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.concat(t)}),[]).filter((function(e){return n.some((function(t){return t.name===e.name}))})).filter((function(e){return"symbol"===e.artboard_type&&(e.name||"").toUpperCase().indexOf(r.toUpperCase())>=0}));return c.a.createElement(Z,{groups:i,showFeedBack:!0})},Pe=(n(192),n(113));function Ae(e){var t=e.title,n=e.percent,a=e.loading,r=e.onCancel,o=e.type,i={import:"导入",export:"导出"}[o],l=[n<100?c.a.createElement(f.a,{key:"cancel",onClick:r},c.a.createElement(E.a,{type:"stop",style:{color:x.volcano[4]}}),"取消",i):c.a.createElement("div",{key:"actions"},c.a.createElement(f.a,{key:"success",style:{borderColor:"transparent",pointerEvents:"none",padding:0}},c.a.createElement(E.a,{type:"check",style:{color:x.green.primary}}),i,"成功！"),"import"===o&&c.a.createElement("a",{href:"https://www.yuque.com/yuque/help/koe3wi#13d0ab6f",target:"_blank",onClick:function(){return Object(ye.a)("open",["https://www.yuque.com/yuque/help/koe3wi#13d0ab6f"])}},"了解如何使用"))];return c.a.createElement(d.a,{visible:a,closable:!1,title:"正在".concat(i).concat(t?" | ".concat(t):""),footer:l,transitionName:"fade"},c.a.createElement(Pe.a,{percent:n,status:n<100?"active":void 0}))}var Be=n(25),Fe=n.n(Be),Te=n(35),Ve=n.n(Te);function Ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(n),!0).forEach((function(t){de()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Me={INTERNEL:{url:"/api/v2/kitchen/repos/83045/assets",repo:{id:"SELECTED-83045",user:{login:"kitchen",name:"kitchen"},name:"✨ 精选 Library",slug:"library"}},PUBLIC:{url:"/api/v2/kitchen/repos/174725/assets",repo:{id:"SELECTED-174725",user:{login:"kitchen",name:"kitchen"},name:"✨ 精选 Library",slug:"library"}}};function We(e){var t=e.dispatch,n=e.isInternal,a=function(){var e=Ve()(Fe.a.mark((function e(){var t;return Fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u()("/api/v2/kitchen/repos");case 2:return t=e.sent,e.abrupt("return",t.data.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),r=function(){var e=Ve()(Fe.a.mark((function e(t){var n;return Fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u()("".concat("/api/v2/kitchen/repos","/").concat(t,"/artboard_groups"));case 2:return n=e.sent,e.abrupt("return",n.data.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(e,n){var a=n.find((function(t){return t.id===e}));if(a)return a.loading=!0,t({type:"changeRepos",payload:w()(n)}),r(e).then((function(e){Object.assign(a,{groups:e.map((function(e){return ze(ze({},e),{},{parentRepo:a})})),loading:!1}),t({type:"changeRepos",payload:w()(n)})}))},i=function(){var e=Ve()(Fe.a.mark((function e(){var t,a,r;return Fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Me[n?"INTERNEL":"PUBLIC"],e.next=3,u()("".concat(t.url));case 3:return a=e.sent,r=(a.data.data||[]).map((function(e){return ze(ze({},e),{},{name:e.name.replace(/\.sketch$/,""),parentRepo:t.repo})})),e.abrupt("return",ze(ze({},t.repo),{},{groups:r}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=function(e){var t=function(){Object(ye.a)("getAllLibraries")};return Object(o.useEffect)((function(){window.changeImportedLibraries=function(t){e({type:"changeImportedLibraries",payload:t})},t()}),[]),[t]}(t),s=O()(l,1)[0];return Object(o.useEffect)((function(){return a().then((function(e){return t({type:"changeRepos",payload:e}),e})).then((function(e){e.forEach((function(t){c(t.id,e)}))})),i().then((function(e){t({type:"changeSelected",payload:e})})),window.importProgress=function(e){t({type:"changeImportingOrExporting",payload:{type:"import",percent:e.percent,message:"true"===e.message?"":e.message}}),(e.success||e.fail)&&(s(),setTimeout((function(){t({type:"changeImportingOrExporting",payload:null})}),2e3)),e.success&&(M.a.success("导入 Symbol 成功，可在 Sketch 主界面左上角 + 号中找到"),Object(ye.a)("showLibrariesPane"))},window.exportProgress=function(e){e.success&&t({type:"createSymbolSuccess"}),t({type:"changeImportingOrExporting",payload:{type:"export",percent:e.percent,message:"true"===e.message?"":e.message}}),(e.success||e.fail)&&setTimeout((function(){t({type:"changeImportingOrExporting",payload:null})}),1e3),e.previewUrl&&"400"===e.previewUrl&&setTimeout((function(){t({type:"showErrorMsg"})}),1e3),e.success&&M.a.success("导出到语雀成功")},function(){window.importProgress=null,window.exportProgress=null}}),[]),[c]}var Xe=n(346),Ye=n.n(Xe);function qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function He(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(n),!0).forEach((function(t){de()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Je=function(){return Object(ye.a)("getCurrentDocumentName"),window.localStorage.getItem("current_sketch_symbol_name")};function Ge(e,t){switch(t.type){case"changeCurrentNavName":return He(He({},e),{},{currentNavName:t.payload,currentSymbol:null,searchValue:""});case"changeCurrentSymbol":return He(He({},e),{},{currentSymbol:t.payload});case"changeRepos":return He(He({},e),{},{repos:t.payload});case"showErrorMsg":return He(He({},e),{},{isFailed:!0});case"resetAfterFailed":return He(He({},e),{},{isFailed:!1});case"changeImportingOrExporting":var n=t.payload||{},a=n.message,r=n.percent,o=n.groupId,c=n.repoId,i=n.type,l=He(He({},e.importingOrExporting),{},{message:a,percent:Number(r||0)});void 0!==o&&(l.groupId=o),void 0!==c&&(l.repoId=c),void 0!==i&&(l.type=i);var s=e.repos,u=e.importingOrExporting,p=e.LARK_BASE_URL,m=s.find((function(e){return e.id===u.repoId})),d=m&&m.user&&m.user.login?m.user.login:null,f=m&&m.user&&m.user.type?m.user.type:null,g="Group"===f?"/".concat(d):"",y="".concat(p).concat(g,"/settings/member");return He(He({},e),{},{importingOrExporting:l,selectedRepoType:f,previewUrl:y});case"changeSearchValue":return He(He({},e),{},{searchValue:t.payload});case"createSymbol":var b=Je();return b?He(He({},e),{},{newSymbol:{repoId:t.payload.repoId,name:Ye.a.basename(b,".sketch")||"新模板"}}):(M.a.error("请先保存当前 sketch 文件"),e);case"createSymbolSuccess":var E=e.repos,v=e.newSymbol;if(!v||!v.repoId)return e;var h=E.find((function(e){return e.id===v.repoId}));return h?(h.groups=h.groups.concat({name:v.name,id:"NEW_".concat(v.name),artboard_type:"symbol",parentRepo:h}),He(He({},e),{},{newSymbol:null,repos:w()(E)})):e;case"changeNewSymbol":return He(He({},e),{},{newSymbol:He(He({},e.newSymbol),t.payload)});case"changeImportedLibraries":return He(He({},e),{},{importedLibraries:t.payload});case"cancelCreateNewSymbol":return He(He({},e),{},{newSymbol:null});case"changeSelected":return He(He({},e),{},{selected:t.payload});default:throw new Error}}var Ze=function(){var e=Ve()(Fe.a.mark((function e(t){var n;return Fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.post("/api/mine/marks",{target_id:t,target_type:"ArtboardGroup"});case 2:return n=e.sent,e.abrupt("return",n.data.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var Qe=n(96),$e=n.n(Qe),et=c.a.createContext(),tt=[{name:"精选",icon:"star",Component:De,hideSearch:!0},{name:"团队",icon:"appstore",description:"上传 Symbol 资产到语雀，共享和维护你们的专属 Symbol 库。",Component:Oe},{name:"收藏",icon:"heart",disabled:!0},{name:"已导入",icon:"project",Component:Ue}],nt=function(e,t){var n=e.LARK_BASE_URL,a=e.isInternal,r=function(e){var t=e.LARK_BASE_URL,n=Object(o.useReducer)(Ge,{currentNavName:tt[0].name,repos:null,importingOrExporting:{},searchValue:"",importedLibraries:[],selected:null,LARK_BASE_URL:t}),a=O()(n,2);return[a[0],a[1]]}({LARK_BASE_URL:n}),i=O()(r,2),l=i[0],s=i[1],u=l.repos,p=l.currentNavName,m=l.currentSymbol,h=l.importingOrExporting,k=l.searchValue,C=l.newSymbol,_=l.importedLibraries,S=l.selected,j=l.isFailed,R=l.selectedRepoType,L=l.previewUrl,D=We({dispatch:s,isInternal:a}),U=O()(D,1)[0],P=function(e){var t=e.dispatch,n=e.context,a=e.fetchArtboardGroupsAndUpdate,r=e.repos;return{onBack:Object(o.useCallback)((function(){t({type:"changeCurrentSymbol",payload:null})})),onStar:Object(o.useCallback)((function(e){Ze(e)})),onImport:Object(o.useCallback)((function(e){t({type:"changeImportingOrExporting",payload:{type:"import",percent:0,groupId:e.id}}),Object(ye.a)("importSymbols",[{repo:e.source_file||e.url,repoName:e.name}]),n.track({action:"点击导入-".concat(e.name)})})),onExport:Object(o.useCallback)((function(e){var a=e.groupId,r=e.repoId,o=e.currentDocumentName;Je()?(t({type:"changeImportingOrExporting",payload:{type:"export",percent:0,groupId:a,repoId:r}}),Object(ye.a)("exportSymbols",[{group:a,repo:r,currentDocumentName:o}]),n.track({action:"点击导出-".concat(a,"/").concat(r)})):M.a.error("请先保存当前 sketch 文件")})),onReload:Object(o.useCallback)((function(e){a(e,r)})),onCancel:Object(o.useCallback)((function(){Object(ye.a)("cancelExport"),t({type:"changeImportingOrExporting",payload:null})}))}}({dispatch:s,context:t,fetchArtboardGroupsAndUpdate:U,repos:u}),A=P.onBack,B=P.onStar,F=P.onImport,T=P.onExport,V=P.onReload,K=P.onCancel,z=tt.find((function(e){return e.name===p})),W=I()((function(e){s({type:"changeSearchValue",payload:e})}),200,[]),X=O()(W,1)[0];return c.a.createElement(et.Provider,{value:{repos:u,dispatch:s,pluginCall:ye.a,LARK_BASE_URL:n,importingOrExporting:h,onImport:F,onExport:T,onReload:V,searchValue:k,newSymbol:C,importedLibraries:_,selected:S,isFailed:j,selectedRepoType:R}},c.a.createElement(g.a,{type:"flex",style:{overflow:"hidden",height:"100vh"}},c.a.createElement(y.a,{style:{width:180}},c.a.createElement("div",{className:$e.a.sider},c.a.createElement("ul",null,tt.map((function(e){var t=e.name,n=e.icon,a=e.disabled;return c.a.createElement("li",{key:t,onClick:function(){a||s({type:"changeCurrentNavName",payload:t})},className:N()({[$e.a.current]:t===p,[$e.a.disabled]:a})},c.a.createElement(b.a,{title:a?"敬请期待":"",placement:"right"},c.a.createElement(E.a,{type:n,className:$e.a.icon}),c.a.createElement("span",{style:{paddingRight:4}},t)))}))),c.a.createElement("div",{className:$e.a.advertising},c.a.createElement("img",{src:"https://gw.alipayobjects.com/zos/antfincdn/l2nUuLyWYo/ad.svg",alt:"图标"}),c.a.createElement("div",null,"想要上精选？"),c.a.createElement("div",{className:$e.a.link},c.a.createElement("a",{href:"https://www.yuque.com/docs/share/542a94c9-7337-4c9c-ab6e-7b2d2117c5c1",target:"_blank",onClick:function(){return Object(ye.a)("open",["https://www.yuque.com/docs/share/542a94c9-7337-4c9c-ab6e-7b2d2117c5c1"])}},"立即了解"))))),c.a.createElement(y.a,{style:{flex:"1"},className:$e.a.content},function(){if(m){var e=m.repoId,t=m.groupId,n=[].concat(w()(u),[S]).find((function(t){return t.id===e}));if(n&&n.groups){var a=n.groups.find((function(e){return e.id===t}));if(a)return c.a.createElement(Ie,{group:a,repo:n,onBack:A,onStar:B})}}return c.a.createElement(c.a.Fragment,null,c.a.createElement("h2",{className:$e.a.title},z.name,z.hideSearch||c.a.createElement(v.a.Search,{style:{width:200},placeholder:"搜索",allowClear:!0,onChange:function(e){var t=e.target;return X(t.value)}})),c.a.createElement("div",{className:$e.a.description},z.description),z.Component&&c.a.createElement(z.Component,null))}())),c.a.createElement(Ae,{title:h.message,loading:!(!h||!h.percent),percent:Number.isNaN(h.percent)?100:Number(h.percent),type:h.type,onCancel:K}),c.a.createElement(d.a,{title:"上传失败，语雀可用上传量不足",visible:j,closable:!1,footer:[c.a.createElement(f.a,{key:"back",onClick:function(){window.pluginCall("inspectLark",[L])}},"了解更多"),c.a.createElement(f.a,{key:"cancel",onClick:function(){s({type:"resetAfterFailed"})}},c.a.createElement(E.a,{type:"stop",style:{color:x.volcano[4]}}),"取消导出")]},c.a.createElement("p",null,"语雀".concat("User"===R?"普通用户":"基础版团队","上传总量上限为10GB，升级").concat("User"===R?"会员":"高级版","可享受 100GB 大容量上传"))))};nt.contextTypes={track:_.a.func};var at=nt,rt=n(62),ot=(n(251),Object(m.a)((function(e){return c.a.createElement(at,e)}),"Symbol"));window.init=function(e){u.a.defaults.baseURL=e.LARK_BASE_URL.replace("yuque.antfin-inc","yuque-api.antfin-inc"),u.a.defaults.headers.common["X-Auth-Token"]=e.token,u.a.defaults.params={kitchen:"".concat(e.pluginVersion,"_").concat(e.appVersion)};var t=e.trackData,n=e.login,a=e.userId;if(window._kitchen_symbol_isInit&&window.Tracert&&window.Tracert.click("syncSymbols.pageView",{UUID:t.cnzzUUID}),window.__WPO&&window.__WPO.setConfig({nick:n||a,sample:1,spmId:"a412.b4420",imgUrl:"http://retcode.taobao.com/r.png?"}),!window._kitchen_symbol_isInit){var r=e.isDev;(r="true"===String(r)||"1"===String(r))||Object(rt.a)(),window._kitchen_symbol_isInit=!0,l.a.render(c.a.createElement(ot,e),document.getElementById("kitchen-plugin-root"))}};var ct=Object(m.a)(p.a,"Symbol");window.auth=function(e){l.a.render(c.a.createElement(ct,r()({},e,{type:"symbol",pluginCall:window.pluginCall,onComplete:function(){window.pluginCall("init")}})),document.getElementById("kitchen-plugin-root"))}},8:function(e,t){e.exports=ReactDOM},95:function(e,t,n){e.exports={card:"_1DrjIS0rwsgY5aAktI5ulP",content:"_2sJX1pC7rCsAegQVi-KGyC",avatar:"_3srW3USu_Uuh30cvKe_hBE",divider:"_2Gvv44YGpQiBmQdTGGvb9n",isNew:"_2Dsx583pIOD70T1jbeOx9M",actions:"_29UJAY1ufZm_iHwB-iXP5t",pending:"_5VrTC15e0YswBpFNui5-v"}},96:function(e,t,n){e.exports={sider:"FxX4p2K8rfyy4l02TxNXp",icon:"_1mn5r9l_n8fUO6j3wHoNJe",current:"_11VyWtNLSKt3TFb47_blP9",disabled:"_1UG3932Xt0UubJqGaLL-S9",advertising:"q7nsBZ7WGK9vNniJtzplT",link:"_3Mjef5T1DIVrYj7IFDmdAb",content:"LMy-oJWy_FN0eCZJ-58z4",title:"_3ceXMzAzd4DuCmQc3y8biE",description:"_3poJ3EcKipJHXkIknStD1v"}}});